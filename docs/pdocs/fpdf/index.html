<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>fpdf API documentation</title>
    <meta name="description" content="pyfpdf: FPDF for Python

Simple PDF generation for Python. PyFPDF is a library for PDF document
gene..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#fpdf.FPDF_CACHE_DIR">FPDF_CACHE_DIR</a></li>
    <li class="mono"><a href="#fpdf.FPDF_CACHE_MODE">FPDF_CACHE_MODE</a></li>
    <li class="mono"><a href="#fpdf.FPDF_FONT_DIR">FPDF_FONT_DIR</a></li>
    <li class="mono"><a href="#fpdf.FPDF_VERSION">FPDF_VERSION</a></li>
    <li class="mono"><a href="#fpdf.SYSTEM_TTFONTS">SYSTEM_TTFONTS</a></li>
    <li class="mono"><a href="#fpdf.__license__">__license__</a></li>
    <li class="mono"><a href="#fpdf.__version__">__version__</a></li>
  </ul>

    </li>


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#fpdf.FPDF">FPDF</a></span>
        
          
  <ul>
    <li class="mono"><a href="#fpdf.FPDF.__init__">__init__</a></li>
    <li class="mono"><a href="#fpdf.FPDF.add_font">add_font</a></li>
    <li class="mono"><a href="#fpdf.FPDF.add_link">add_link</a></li>
    <li class="mono"><a href="#fpdf.FPDF.add_page">add_page</a></li>
    <li class="mono"><a href="#fpdf.FPDF.alias_nb_pages">alias_nb_pages</a></li>
    <li class="mono"><a href="#fpdf.FPDF.cell">cell</a></li>
    <li class="mono"><a href="#fpdf.FPDF.check_page">check_page</a></li>
    <li class="mono"><a href="#fpdf.FPDF.close">close</a></li>
    <li class="mono"><a href="#fpdf.FPDF.dashed_line">dashed_line</a></li>
    <li class="mono"><a href="#fpdf.FPDF.ellipse">ellipse</a></li>
    <li class="mono"><a href="#fpdf.FPDF.error">error</a></li>
    <li class="mono"><a href="#fpdf.FPDF.footer">footer</a></li>
    <li class="mono"><a href="#fpdf.FPDF.get_string_width">get_string_width</a></li>
    <li class="mono"><a href="#fpdf.FPDF.get_x">get_x</a></li>
    <li class="mono"><a href="#fpdf.FPDF.get_y">get_y</a></li>
    <li class="mono"><a href="#fpdf.FPDF.header">header</a></li>
    <li class="mono"><a href="#fpdf.FPDF.image">image</a></li>
    <li class="mono"><a href="#fpdf.FPDF.line">line</a></li>
    <li class="mono"><a href="#fpdf.FPDF.link">link</a></li>
    <li class="mono"><a href="#fpdf.FPDF.ln">ln</a></li>
    <li class="mono"><a href="#fpdf.FPDF.multi_cell">multi_cell</a></li>
    <li class="mono"><a href="#fpdf.FPDF.normalize_text">normalize_text</a></li>
    <li class="mono"><a href="#fpdf.FPDF.open">open</a></li>
    <li class="mono"><a href="#fpdf.FPDF.output">output</a></li>
    <li class="mono"><a href="#fpdf.FPDF.page_no">page_no</a></li>
    <li class="mono"><a href="#fpdf.FPDF.rect">rect</a></li>
    <li class="mono"><a href="#fpdf.FPDF.rotate">rotate</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_author">set_author</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_auto_page_break">set_auto_page_break</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_compression">set_compression</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_creation_date">set_creation_date</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_creator">set_creator</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_display_mode">set_display_mode</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_doc_option">set_doc_option</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_draw_color">set_draw_color</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_fill_color">set_fill_color</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_font">set_font</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_font_size">set_font_size</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_keywords">set_keywords</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_left_margin">set_left_margin</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_line_width">set_line_width</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_link">set_link</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_margins">set_margins</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_right_margin">set_right_margin</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_stretching">set_stretching</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_subject">set_subject</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_text_color">set_text_color</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_title">set_title</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_top_margin">set_top_margin</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_x">set_x</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_xy">set_xy</a></li>
    <li class="mono"><a href="#fpdf.FPDF.set_y">set_y</a></li>
    <li class="mono"><a href="#fpdf.FPDF.text">text</a></li>
    <li class="mono"><a href="#fpdf.FPDF.write">write</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#fpdf.HTMLMixin">HTMLMixin</a></span>
        
          
  <ul>
    <li class="mono"><a href="#fpdf.HTMLMixin.write_html">write_html</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#fpdf.Template">Template</a></span>
        
          
  <ul>
    <li class="mono"><a href="#fpdf.Template.__init__">__init__</a></li>
    <li class="mono"><a href="#fpdf.Template.add_page">add_page</a></li>
    <li class="mono"><a href="#fpdf.Template.barcode">barcode</a></li>
    <li class="mono"><a href="#fpdf.Template.has_key">has_key</a></li>
    <li class="mono"><a href="#fpdf.Template.image">image</a></li>
    <li class="mono"><a href="#fpdf.Template.line">line</a></li>
    <li class="mono"><a href="#fpdf.Template.load_elements">load_elements</a></li>
    <li class="mono"><a href="#fpdf.Template.parse_csv">parse_csv</a></li>
    <li class="mono"><a href="#fpdf.Template.rect">rect</a></li>
    <li class="mono"><a href="#fpdf.Template.render">render</a></li>
    <li class="mono"><a href="#fpdf.Template.set">set</a></li>
    <li class="mono"><a href="#fpdf.Template.split_multicell">split_multicell</a></li>
    <li class="mono"><a href="#fpdf.Template.text">text</a></li>
    <li class="mono"><a href="#fpdf.Template.write">write</a></li>
  </ul>

        </li>
      </ul>
    </li>

    <li class="set"><h3><a href="#header-submodules">Sub-modules</a></h3>
      <ul>
        <li class="mono"><a href="errors.m.html">fpdf.errors</a></li>
        <li class="mono"><a href="fonts.m.html">fpdf.fonts</a></li>
        <li class="mono"><a href="fpdf.m.html">fpdf.fpdf</a></li>
        <li class="mono"><a href="html.m.html">fpdf.html</a></li>
        <li class="mono"><a href="image_parsing.m.html">fpdf.image_parsing</a></li>
        <li class="mono"><a href="php.m.html">fpdf.php</a></li>
        <li class="mono"><a href="py3k.m.html">fpdf.py3k</a></li>
        <li class="mono"><a href="template.m.html">fpdf.template</a></li>
        <li class="mono"><a href="ttfonts.m.html">fpdf.ttfonts</a></li>
        <li class="mono"><a href="util.m.html">fpdf.util</a></li>
      </ul>
    </li>
    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">fpdf</span> module</h1>
  <p>pyfpdf: FPDF for Python</p>
<p>Simple PDF generation for Python. PyFPDF is a library for PDF document
generation under Python, ported from PHP (see <a href="http://www.fpdf.org/">FPDF</a>: "Free"-PDF, a
well-known PDFlib-extension replacement with many examples, scripts
and derivatives).</p>
<p>Compared with other PDF libraries, PyFPDF is simple, small and versatile, with
advanced capabilities, and is easy to learn, extend and maintain.</p>
<p>For introductory material see
<a href="http://pyfpdf.readthedocs.org/en/latest/">Read the Docs</a>, and for additional
documentation see the <a href="fpdf.m.html"><code>fpdf.fpdf</code></a> submodule.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf', this);">Show source &equiv;</a></p>
  <div id="source-fpdf" class="source">
    <div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;pyfpdf: FPDF for Python</span>

<span class="sd">Simple PDF generation for Python. PyFPDF is a library for PDF document</span>
<span class="sd">generation under Python, ported from PHP (see [FPDF][1]: &quot;Free&quot;-PDF, a</span>
<span class="sd">well-known PDFlib-extension replacement with many examples, scripts</span>
<span class="sd">and derivatives).</span>

<span class="sd">Compared with other PDF libraries, PyFPDF is simple, small and versatile, with</span>
<span class="sd">advanced capabilities, and is easy to learn, extend and maintain.</span>

<span class="sd">  [1]: http://www.fpdf.org/</span>

<span class="sd">For introductory material see</span>
<span class="sd">[Read the Docs](http://pyfpdf.readthedocs.org/en/latest/), and for additional</span>
<span class="sd">documentation see the `fpdf.fpdf` submodule.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.fpdf</span> <span class="kn">import</span> <span class="n">FPDF_VERSION</span> <span class="k">as</span> <span class="n">_FPDF_VERSION</span><span class="p">,</span> \
                  <span class="n">FPDF_CACHE_MODE</span> <span class="k">as</span> <span class="n">_FPDF_CACHE_MODE</span><span class="p">,</span> \
                  <span class="n">FPDF_FONT_DIR</span> <span class="k">as</span> <span class="n">_FPDF_FONT_DIR</span><span class="p">,</span> \
                  <span class="n">FPDF_CACHE_DIR</span> <span class="k">as</span> <span class="n">_FPDF_CACHE_DIR</span><span class="p">,</span> \
                  <span class="n">SYSTEM_TTFONTS</span> <span class="k">as</span> <span class="n">_SYSTEM_TTFONTS</span>

<span class="n">FPDF_VERSION</span> <span class="o">=</span> <span class="n">_FPDF_VERSION</span>
<span class="sd">&quot;&quot;&quot;Current FPDF Version, also available via `__version__` (which is read by</span>
<span class="sd">`setup.py`):</span>

<span class="sd">&lt;pre&gt;</span>
<span class="sd">&gt;&gt;&gt; import fpdf</span>
<span class="sd">&gt;&gt;&gt; fpdf.__version__</span>
<span class="sd">&#39;1.7.3&#39;</span>
<span class="sd">&lt;/pre&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">FPDF_CACHE_MODE</span> <span class="o">=</span> <span class="n">_FPDF_CACHE_MODE</span>

<span class="n">FPDF_CACHE_DIR</span> <span class="o">=</span> <span class="n">_FPDF_CACHE_DIR</span>
<span class="sd">&quot;&quot;&quot;This is the directory where pickle files for TTF font files are kept</span>
<span class="sd">containing meta-data and stuffs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">FPDF_FONT_DIR</span> <span class="o">=</span> <span class="n">_FPDF_FONT_DIR</span>
<span class="sd">&quot;&quot;&quot;This is the location of where to look for fonts.&quot;&quot;&quot;</span>

<span class="n">SYSTEM_TTFONTS</span> <span class="o">=</span> <span class="n">_SYSTEM_TTFONTS</span>
<span class="sd">&quot;&quot;&quot;This is the directory searched for fonts when a font file path is not</span>
<span class="sd">given.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.fpdf</span> <span class="kn">import</span> <span class="n">FPDF</span>

<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;LGPL 3.0&quot;</span>
<span class="sd">&quot;&quot;&quot;LGPL 3.0 license&quot;&quot;&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="n">FPDF_VERSION</span>
<span class="sd">&quot;&quot;&quot;Version as reflected in `setup.py` and PyPI.&quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
  <span class="kn">from</span> <span class="nn">.html</span> <span class="kn">import</span> <span class="n">HTMLMixin</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">warnings</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;web2py gluon package not installed, required for html2pdf&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.template</span> <span class="kn">import</span> <span class="n">Template</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
  <span class="c1"># metadata</span>
  <span class="s1">&#39;__version__&#39;</span><span class="p">,</span> <span class="s1">&#39;__license__&#39;</span><span class="p">,</span>

  <span class="c1"># Classes</span>
  <span class="s1">&#39;FPDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span> <span class="s1">&#39;HTMLMixin&#39;</span><span class="p">,</span>

  <span class="c1"># FPDF Constants</span>
  <span class="s1">&#39;FPDF_VERSION&#39;</span><span class="p">,</span> <span class="s1">&#39;FPDF_CACHE_MODE&#39;</span><span class="p">,</span> <span class="s1">&#39;FPDF_CACHE_DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;FPDF_FONT_DIR&#39;</span><span class="p">,</span>
  <span class="s1">&#39;SYSTEM_TTFONTS&#39;</span>
<span class="p">]</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="fpdf.FPDF_CACHE_DIR" class="name">var <span class="ident">FPDF_CACHE_DIR</span></p>
      
  
    <div class="desc"><p>This is the directory where pickle files for TTF font files are kept
containing meta-data and stuffs.</p></div>
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.FPDF_CACHE_MODE" class="name">var <span class="ident">FPDF_CACHE_MODE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.FPDF_FONT_DIR" class="name">var <span class="ident">FPDF_FONT_DIR</span></p>
      
  
    <div class="desc"><p>This is the location of where to look for fonts.</p></div>
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.FPDF_VERSION" class="name">var <span class="ident">FPDF_VERSION</span></p>
      
  
    <div class="desc"><p>Current FPDF Version, also available via <code>__version__</code> (which is read by
<code>setup.py</code>):</p>
<pre>
>>> import fpdf
>>> fpdf.__version__
'1.7.3'
</pre></div>
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.SYSTEM_TTFONTS" class="name">var <span class="ident">SYSTEM_TTFONTS</span></p>
      
  
    <div class="desc"><p>This is the directory searched for fonts when a font file path is not
given.</p></div>
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.__license__" class="name">var <span class="ident">__license__</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="fpdf.__version__" class="name">var <span class="ident">__version__</span></p>
      
  
  <div class="source_cont">
</div>

      </div>


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="fpdf.FPDF" class="name">class <span class="ident">FPDF</span></p>
      
  
    <div class="desc"><p>PDF Generation class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">FPDF</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&quot;PDF Generation class&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;A4&#39;</span><span class="p">):</span>
        <span class="c1"># Initialization of properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="p">{}</span>               <span class="c1"># array of object offsets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># current page number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>                      <span class="c1"># current object number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                <span class="c1"># buffer holding in-memory PDF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array containing pages and metadata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># current document state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of used fonts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span> <span class="o">=</span> <span class="p">{}</span>            <span class="c1"># array of font files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of encoding differences</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>                <span class="c1"># array of used images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span> <span class="o">=</span> <span class="p">{}</span>            <span class="c1"># array of links in pages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of internal links</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c1"># flag set when processing footer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastw</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lasth</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># height of last cell printed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>           <span class="c1"># current font family</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>            <span class="c1"># current font style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">=</span> <span class="mi">12</span>          <span class="c1"># current font size in points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">=</span> <span class="mi">100</span>      <span class="c1"># current font stretching</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c1"># underlining flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="s1">&#39;0 G&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="s1">&#39;0 g&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="s1">&#39;0 g&#39;</span>
        <span class="c1"># indicates whether fill and text colors are different</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># word spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Standard fonts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;courier&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier&#39;</span><span class="p">,</span> <span class="s1">&#39;courierB&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Bold&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;courierI&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Oblique&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;courierBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-BoldOblique&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;helvetica&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;helveticaB&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;helveticaI&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Oblique&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;helveticaBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-BoldOblique&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;times&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Roman&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;timesB&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Bold&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;timesI&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Italic&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;timesBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-BoldItalic&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Symbol&#39;</span><span class="p">,</span> <span class="s1">&#39;zapfdingbats&#39;</span><span class="p">:</span> <span class="s1">&#39;ZapfDingbats&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span> <span class="o">=</span> <span class="s2">&quot;latin-1&quot;</span>

        <span class="c1"># Scale factor</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pt&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">72</span> <span class="o">/</span> <span class="mf">25.4</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;cm&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">72</span> <span class="o">/</span> <span class="mf">2.54</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mf">72.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;Incorrect unit: &quot;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">)</span>

        <span class="c1"># Page format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">=</span> <span class="n">get_page_format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dw_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dh_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

        <span class="c1"># Page orientation</span>
        <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
        <span class="k">elif</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect orientation: &#39;</span> <span class="o">+</span> <span class="n">orientation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur_orientation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>

        <span class="c1"># Page spacing</span>
        <span class="c1"># Page margins (1 cm)</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="mf">28.35</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_margins</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span> <span class="o">=</span> <span class="n">margin</span> <span class="o">/</span> <span class="mf">10.0</span>            <span class="c1"># Interior cell margin (1 mm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="o">.</span><span class="mi">567</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>          <span class="c1"># line width (0.2 mm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">)</span>  <span class="c1"># Automatic page break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_display_mode</span><span class="p">(</span><span class="s1">&#39;fullwidth&#39;</span><span class="p">)</span>       <span class="c1"># Full width display mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_compression</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                  <span class="c1"># Enable compression</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="s1">&#39;1.3&#39;</span>                 <span class="c1"># Set default PDF version No.</span>

    <span class="k">def</span> <span class="nf">check_page</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="s2">&quot;Decorator to protect drawing methods&quot;</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
                <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="nf">set_margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="s2">&quot;Set left, top and right margins&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span> <span class="o">=</span> <span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_margin</span> <span class="o">=</span> <span class="n">top</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">=</span> <span class="n">right</span>

    <span class="k">def</span> <span class="nf">set_left_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="s2">&quot;Set left margin&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span> <span class="o">=</span> <span class="n">margin</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">margin</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">margin</span>

    <span class="k">def</span> <span class="nf">set_top_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="s2">&quot;Set top margin&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_margin</span> <span class="o">=</span> <span class="n">margin</span>

    <span class="k">def</span> <span class="nf">set_right_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="s2">&quot;Set right margin&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">=</span> <span class="n">margin</span>

    <span class="k">def</span> <span class="nf">set_auto_page_break</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="s2">&quot;Set auto page break mode and triggering margin&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_page_break</span> <span class="o">=</span> <span class="n">auto</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_margin</span> <span class="o">=</span> <span class="n">margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_break_trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">margin</span>

    <span class="k">def</span> <span class="nf">set_display_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;continuous&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set display mode in viewer</span>

<span class="sd">        The &quot;zoom&quot; argument may be &#39;fullpage&#39;, &#39;fullwidth&#39;, &#39;real&#39;,</span>
<span class="sd">        &#39;default&#39;, or a number, interpreted as a percentage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">zoom</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fullpage&#39;</span><span class="p">,</span> <span class="s1">&#39;fullwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">=</span> <span class="n">zoom</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">=</span> <span class="n">zoom</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect zoom display mode: &#39;</span> <span class="o">+</span> <span class="n">zoom</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">layout</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;continuous&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout_mode</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect layout display mode: &#39;</span> <span class="o">+</span> <span class="n">layout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compress</span><span class="p">):</span>
        <span class="s2">&quot;Set page compression&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="n">compress</span>

    <span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="s2">&quot;Title of document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>

    <span class="k">def</span> <span class="nf">set_subject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">):</span>
        <span class="s2">&quot;Subject of document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="n">subject</span>

    <span class="k">def</span> <span class="nf">set_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="s2">&quot;Author of document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>

    <span class="k">def</span> <span class="nf">set_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="p">):</span>
        <span class="s2">&quot;Keywords of document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>

    <span class="k">def</span> <span class="nf">set_creator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">creator</span><span class="p">):</span>
        <span class="s2">&quot;Creator of document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">creator</span> <span class="o">=</span> <span class="n">creator</span>

    <span class="k">def</span> <span class="nf">set_creation_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets Creation of Date time, or current time if None given.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">date</span>

    <span class="k">def</span> <span class="nf">set_doc_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="s2">&quot;Set document option&quot;</span>
        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;core_fonts_encoding&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;Unknown document option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">alias_nb_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;{nb}&#39;</span><span class="p">):</span>
        <span class="s2">&quot;Define an alias for total number of pages&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_alias_nb_pages</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="k">return</span> <span class="n">alias</span>

    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="s2">&quot;Fatal error&quot;</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;FPDF error: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Begin document&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Terminate document&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>

        <span class="c1"># Page footer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">footer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_endpage</span><span class="p">()</span>  <span class="c1"># close page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enddoc</span><span class="p">()</span>   <span class="c1"># close document</span>

    <span class="k">def</span> <span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">same</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="s2">&quot;Start a new page, if same page format will be same as previous&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="n">family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>
        <span class="n">style</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">+</span> <span class="s1">&#39;U&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span>
        <span class="n">size</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>
        <span class="n">lw</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span>
        <span class="n">dc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span>
        <span class="n">fc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span>
        <span class="n">tc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span>
        <span class="n">cf</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span>
        <span class="n">stretching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Page footer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">footer</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># close page</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endpage</span><span class="p">()</span>

        <span class="c1"># Start new page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beginpage</span><span class="p">(</span><span class="n">orientation</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">same</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;2 J&#39;</span><span class="p">)</span>      <span class="c1"># Set line cap style to square</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">lw</span>  <span class="c1"># Set line width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

        <span class="c1"># Set font</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">family</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

        <span class="c1"># Set colors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">dc</span>
        <span class="k">if</span> <span class="n">dc</span> <span class="o">!=</span> <span class="s1">&#39;0 G&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">fc</span>
        <span class="k">if</span> <span class="n">fc</span> <span class="o">!=</span> <span class="s1">&#39;0 g&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="n">cf</span>

        <span class="sd">&quot;&quot;&quot; BEGIN Page header &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">!=</span> <span class="n">lw</span><span class="p">):</span>                       <span class="c1"># Restore line width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">lw</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">family</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>  <span class="c1"># Restore font</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">!=</span> <span class="n">dc</span><span class="p">):</span>                      <span class="c1"># Restore colors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">dc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="n">fc</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">fc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="n">cf</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">stretching</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">):</span>                          <span class="c1"># Restore stretching</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_stretching</span><span class="p">(</span><span class="n">stretching</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot; END Page header &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Header to be implemented in your own inherited class&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">footer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Footer to be implemented in your own inherited class&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">page_no</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Get current page number&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>

    <span class="k">def</span> <span class="nf">set_draw_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="s2">&quot;Set color for all stroking operations&quot;</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> G&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> RG&#39;</span><span class="p">,</span>
                                      <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_fill_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="s2">&quot;Set color for all filling operations&quot;</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> g&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> rg&#39;</span><span class="p">,</span>
                                      <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_text_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="s2">&quot;Set color for text&quot;</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> g&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> rg&#39;</span><span class="p">,</span>
                                      <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_string_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="s2">&quot;Get width of a string in the current font&quot;</span>
        <span class="c1"># normalized is parameter for internal use</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">normalized</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">cw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">]</span>
        <span class="n">w</span>  <span class="o">=</span> <span class="mi">0</span>
        <span class="n">l</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">char</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">+=</span> <span class="n">cw</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
                <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">]):</span>
                    <span class="n">w</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">+=</span> <span class="mi">500</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
                <span class="n">w</span> <span class="o">+=</span> <span class="n">cw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">/</span> <span class="mf">100.0</span>
        <span class="k">return</span> <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">/</span> <span class="mf">1000.0</span>

    <span class="k">def</span> <span class="nf">set_line_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="s2">&quot;Set line width&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
        <span class="s2">&quot;Draw a line&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> l S&#39;</span><span class="p">,</span>
                          <span class="n">x1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                          <span class="n">x2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_dash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dash_length</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dash_length</span> <span class="ow">and</span> <span class="n">space_length</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1">] 0 d&#39;</span><span class="p">,</span>
                        <span class="n">dash_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;[] 0 d&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">dashed_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dash_length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw a dashed line. Same interface as line() except:</span>
<span class="sd">           - dash_length: Length of the dash</span>
<span class="sd">           - space_length: Length of the space between dashes&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dash</span><span class="p">(</span><span class="n">dash_length</span><span class="p">,</span> <span class="n">space_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dash</span><span class="p">()</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Draw a rectangle&quot;</span>
        <span class="n">style_to_operators</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FD&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DF&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span>
        <span class="p">}</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">style_to_operators</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> re </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                          <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                          <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">op</span><span class="p">))</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">ellipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Draw a ellipse&quot;</span>
        <span class="n">style_to_operators</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FD&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DF&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span>
        <span class="p">}</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">style_to_operators</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>

        <span class="n">cx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">w</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">cy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">ry</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">2.0</span>

        <span class="n">lx</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rx</span>
        <span class="n">ly</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ry</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> c&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span>        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ly</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">lx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="n">cx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> c&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">lx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">ly</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span>        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> c&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">ly</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">-</span> <span class="n">lx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="n">cx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> c </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">lx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">ry</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">cy</span> <span class="o">+</span> <span class="n">ly</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">rx</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">op</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">uni</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="s2">&quot;Add a TrueType or Type1 font&quot;</span>
        <span class="n">family</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.pkl&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;arial&#39;</span><span class="p">):</span> <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;helvetica&#39;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;IB&#39;</span><span class="p">):</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;BI&#39;</span>
        <span class="n">fontkey</span> <span class="o">=</span> <span class="n">family</span> <span class="o">+</span> <span class="n">style</span>

        <span class="c1"># Font already added!</span>
        <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">uni</span><span class="p">):</span>
            <span class="k">global</span> <span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">FPDF_CACHE_MODE</span><span class="p">,</span> <span class="n">FPDF_CACHE_DIR</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
                <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">fname</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">FPDF_FONT_DIR</span> <span class="ow">and</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">fname</span><span class="p">))):</span>
                <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">SYSTEM_TTFONTS</span> <span class="ow">and</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">fname</span><span class="p">))):</span>
                <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TTF Font file not found: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># noqa: F841</span>
            <span class="k">if</span> <span class="n">FPDF_CACHE_MODE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">unifilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.pkl&#39;</span>
            <span class="k">elif</span> <span class="n">FPDF_CACHE_MODE</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">unifilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_CACHE_DIR</span><span class="p">,</span>
                    <span class="n">hashpath</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.pkl&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unifilename</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="n">font_dict</span> <span class="o">=</span> <span class="n">load_cache</span><span class="p">(</span><span class="n">unifilename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">font_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ttf</span> <span class="o">=</span> <span class="n">TTFontFile</span><span class="p">()</span>
                <span class="n">ttf</span><span class="o">.</span><span class="n">getMetrics</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span>
                <span class="n">desc</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;Ascent&#39;</span>       <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">ascent</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="s1">&#39;Descent&#39;</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="s1">&#39;CapHeight&#39;</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">capHeight</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="s1">&#39;Flags&#39;</span>        <span class="p">:</span> <span class="n">ttf</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
                    <span class="s1">&#39;FontBBox&#39;</span>     <span class="p">:</span> <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">))),</span>
                    <span class="s1">&#39;ItalicAngle&#39;</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">italicAngle</span><span class="p">),</span>
                    <span class="s1">&#39;StemV&#39;</span>        <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">stemV</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="s1">&#39;MissingWidth&#39;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">defaultWidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="p">}</span>

                <span class="c1"># Generate metrics .pkl file</span>
                <span class="n">font_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;name&#39;</span>         <span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[ ()]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ttf</span><span class="o">.</span><span class="n">fullName</span><span class="p">),</span>
                    <span class="s1">&#39;type&#39;</span>         <span class="p">:</span> <span class="s1">&#39;TTF&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;desc&#39;</span>         <span class="p">:</span> <span class="n">desc</span><span class="p">,</span>
                    <span class="s1">&#39;up&#39;</span>           <span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">underlinePosition</span><span class="p">),</span>
                    <span class="s1">&#39;ut&#39;</span>           <span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">underlineThickness</span><span class="p">),</span>
                    <span class="s1">&#39;ttffile&#39;</span>      <span class="p">:</span> <span class="n">ttffilename</span><span class="p">,</span>
                    <span class="s1">&#39;fontkey&#39;</span>      <span class="p">:</span> <span class="n">fontkey</span><span class="p">,</span>
                    <span class="s1">&#39;originalsize&#39;</span> <span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span>
                    <span class="s1">&#39;cw&#39;</span>           <span class="p">:</span> <span class="n">ttf</span><span class="o">.</span><span class="n">charWidths</span><span class="p">,</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="n">unifilename</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unifilename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">font_dict</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">:</span>
                            <span class="k">raise</span>  <span class="c1"># Not a permission error.</span>
                <span class="k">del</span> <span class="n">ttf</span>

            <span class="c1"># include numbers in the subset! (if alias present)</span>
            <span class="n">have_page_alias</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;str_alias_nb_pages&#39;</span><span class="p">)</span>
            <span class="n">sbarr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">57</span> <span class="k">if</span> <span class="n">have_page_alias</span><span class="p">()</span> <span class="k">else</span> <span class="mi">32</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;i&#39;</span>           <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
                <span class="s1">&#39;name&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="s1">&#39;desc&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">],</span>
                <span class="s1">&#39;up&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">],</span>
                <span class="s1">&#39;ut&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;ut&#39;</span><span class="p">],</span>
                <span class="s1">&#39;cw&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">],</span>
                <span class="s1">&#39;ttffile&#39;</span>     <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;ttffile&#39;</span><span class="p">],</span>
                <span class="s1">&#39;fontkey&#39;</span>     <span class="p">:</span> <span class="n">fontkey</span><span class="p">,</span>
                <span class="s1">&#39;subset&#39;</span>      <span class="p">:</span> <span class="n">sbarr</span><span class="p">,</span>
                <span class="s1">&#39;unifilename&#39;</span> <span class="p">:</span> <span class="n">unifilename</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;originalsize&#39;</span><span class="p">],</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s2">&quot;TTF&quot;</span><span class="p">,</span> <span class="s1">&#39;ttffile&#39;</span><span class="p">:</span> <span class="n">ttffilename</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">fname</span><span class="p">]</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s2">&quot;TTF&quot;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fontfile</span><span class="p">:</span>
                <span class="n">font_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fontfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">font_dict</span><span class="p">)</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">font_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diff</span><span class="p">):</span>
                <span class="c1"># Search existing encodings</span>
                <span class="n">d</span>  <span class="o">=</span> <span class="mi">0</span>
                <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">diff</span><span class="p">):</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">i</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">][</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">font_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TrueType&#39;</span><span class="p">):</span>
                    <span class="n">originalsize</span> <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;originalsize&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">originalsize</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;size1&#39;</span><span class="p">],</span>
                                                 <span class="s1">&#39;length2&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;size2&#39;</span><span class="p">]}</span>

    <span class="k">def</span> <span class="nf">set_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="s2">&quot;Select a font; size given in points&quot;</span>
        <span class="n">family</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;arial&#39;</span><span class="p">):</span>
            <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;helvetica&#39;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;symbol&#39;</span> <span class="ow">or</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;zapfdingbats&#39;</span><span class="p">):</span>
            <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;U&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;IB&#39;</span><span class="p">):</span>
            <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;BI&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>

        <span class="c1"># Test if font is already selected</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">family</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">==</span> <span class="n">style</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">==</span> <span class="n">size</span><span class="p">):</span> <span class="k">return</span>

        <span class="c1"># Test if used for the first time</span>
        <span class="n">fontkey</span> <span class="o">=</span> <span class="n">family</span> <span class="o">+</span> <span class="n">style</span>
        <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">:</span>
            <span class="c1"># Check if one of standard fonts</span>
            <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fpdf_charwidths</span><span class="p">:</span>
                    <span class="c1"># Load metric file</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">family</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;times&#39;</span> <span class="ow">or</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;helvetica&#39;</span><span class="p">):</span>
                        <span class="n">name</span> <span class="o">+=</span> <span class="n">style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.font&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
                        <span class="k">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.font&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fpdf_charwidths</span><span class="p">:</span>
                        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Could not include font metric file for&#39;</span> <span class="o">+</span>
                                   <span class="n">fontkey</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;i&#39;</span>    <span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span> <span class="p">:</span> <span class="s1">&#39;core&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">],</span>
                    <span class="s1">&#39;up&#39;</span>   <span class="p">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span>
                    <span class="s1">&#39;ut&#39;</span>   <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                    <span class="s1">&#39;cw&#39;</span>   <span class="p">:</span> <span class="n">fpdf_charwidths</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Undefined font: &#39;</span> <span class="o">+</span> <span class="n">family</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">style</span><span class="p">)</span>

        <span class="c1"># Select it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>   <span class="o">=</span> <span class="n">family</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span>    <span class="o">=</span> <span class="n">style</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>  <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>     <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TTF&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT /F</span><span class="si">%d</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Tf ET&#39;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_font_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="s2">&quot;Set font size in points&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">==</span> <span class="n">size</span><span class="p">):</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>    <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT /F</span><span class="si">%d</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Tf ET&#39;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_stretching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="s2">&quot;Set from stretch factor percents (default: 100.0)&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">==</span> <span class="n">factor</span><span class="p">):</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">=</span> <span class="n">factor</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT </span><span class="si">%.2f</span><span class="s1"> Tz ET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_link</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Create a new internal link&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">set_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="s2">&quot;Set destination of internal link&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span>    <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="n">y</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">link</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">page</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
        <span class="s2">&quot;Put a link on the page&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[(</span>
            <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
            <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">h</span>             <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">link</span>
        <span class="p">)]</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="s2">&quot;Output a string&quot;</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">):</span>
            <span class="n">txt2</span> <span class="o">=</span> <span class="n">escape_parens</span><span class="p">(</span><span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">uni</span> <span class="ow">in</span> <span class="n">UTF8StringToArray</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">txt2</span> <span class="o">=</span> <span class="n">escape_parens</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Td (</span><span class="si">%s</span><span class="s1">) Tj ET&#39;</span><span class="p">,</span>
                    <span class="n">x</span>            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                    <span class="n">txt2</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="ow">and</span> <span class="n">txt</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dounderline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;q &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39; Q&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">*=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
            <span class="n">c</span>      <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">s</span>      <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">cx</span>     <span class="o">=</span> <span class="n">x</span>            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">cy</span>     <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;q </span><span class="si">%.5F</span><span class="s1"> </span><span class="si">%.5F</span><span class="s1"> </span><span class="si">%.5F</span><span class="s1"> </span><span class="si">%.5F</span><span class="s1"> </span><span class="si">%.2F</span><span class="s1"> </span><span class="si">%.2F</span><span class="s1"> &#39;</span> <span class="o">+</span>
                        <span class="s1">&#39;cm 1 0 0 1 </span><span class="si">%.2F</span><span class="s1"> </span><span class="si">%.2F</span><span class="s1"> cm&#39;</span><span class="p">,</span>
                        <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="o">-</span><span class="n">cx</span><span class="p">,</span> <span class="o">-</span><span class="n">cy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">accept_page_break</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Accept automatic page break or not&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_page_break</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">border</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">fill</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="s2">&quot;Output a cell, return boolean if triggered auto page break&quot;</span>
        <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_break_trigger</span> <span class="ow">and</span>
             <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="ow">and</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">accept_page_break</span><span class="p">)):</span>

            <span class="c1"># Automatic page break</span>
            <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">x</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ws</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0 Tw&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="n">same</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>  <span class="c1"># restore x but not y after drawing header</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ws</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="n">ws</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> Tw&#39;</span><span class="p">,</span> <span class="n">ws</span> <span class="o">*</span> <span class="n">k</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">fill</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">border</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fill</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">border</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> re </span><span class="si">%s</span><span class="s1"> &#39;</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">x</span>            <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                        <span class="n">w</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> l S &#39;</span><span class="p">,</span>
                             <span class="n">x</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>       <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                             <span class="n">x</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> l S &#39;</span><span class="p">,</span>
                             <span class="n">x</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span>       <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                             <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> l S &#39;</span><span class="p">,</span>
                             <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>       <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                             <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> m </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> l S &#39;</span><span class="p">,</span>
                             <span class="n">x</span>       <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                             <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">txt</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">):</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="bp">True</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span><span class="p">):</span> <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;q &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>

            <span class="c1"># If multibyte, Tw has no effect - do word spacing using an</span>
            <span class="c1"># adjustment before each space</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">uni</span> <span class="ow">in</span> <span class="n">UTF8StringToArray</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
                <span class="n">space</span> <span class="o">=</span> <span class="n">escape_parens</span><span class="p">(</span><span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>

                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT 0 Tw </span><span class="si">%.2F</span><span class="s1"> </span><span class="si">%.2F</span><span class="s1"> Td [&#39;</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>                                            <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)))</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>


                <span class="n">t</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">numt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numt</span><span class="p">):</span>
                    <span class="n">tx</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">tx</span> <span class="o">=</span> <span class="n">enclose_in_parens</span><span class="p">(</span>
                        <span class="n">escape_parens</span><span class="p">(</span><span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>
                    <span class="p">)</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &#39;</span><span class="p">,</span> <span class="n">tx</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">numt</span><span class="p">):</span>
                        <span class="n">adj</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">(</span><span class="si">%s</span><span class="s1">) &#39;</span><span class="p">,</span> <span class="n">adj</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;] TJ&#39;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; ET&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">):</span>
                    <span class="n">txt2</span> <span class="o">=</span> <span class="n">escape_parens</span><span class="p">(</span><span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="bp">False</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">uni</span> <span class="ow">in</span> <span class="n">UTF8StringToArray</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">txt2</span> <span class="o">=</span> <span class="n">escape_parens</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

                <span class="n">s</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Td (</span><span class="si">%s</span><span class="s1">) Tj ET&#39;</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>                                          <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">.</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)))</span> <span class="o">*</span> <span class="n">k</span><span class="p">,</span>
                    <span class="n">txt2</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">underline</span><span class="p">):</span> <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_dounderline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">.</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span>
                                  <span class="n">txt</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span><span class="p">):</span> <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; Q&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">link</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span>  <span class="bp">True</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                          <span class="n">link</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lasth</span> <span class="o">=</span> <span class="n">h</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">ln</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">h</span>  <span class="c1"># Go to next line</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ln</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">w</span>

        <span class="k">return</span> <span class="n">page_break_triggered</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">multi_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">border</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
                   <span class="n">fill</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">split_only</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Output text with automatic or explicit line breaks, returns</span>
<span class="sd">        boolean if page break triggered in output mode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">split_only</span><span class="p">:</span>
            <span class="n">_out</span><span class="p">,</span> <span class="n">_add_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="bp">None</span>

        <span class="c1"># Store this information for manipulating position.</span>
        <span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_x</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_y</span><span class="p">())</span>

        <span class="c1"># If width is 0, set width to available width between margins</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">wmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>

        <span class="c1"># Calculate text length</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">s</span>  <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">normalized_string_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">normalized_string_length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="n">normalized_string_length</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">border</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">border</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">border</span> <span class="o">=</span> <span class="s1">&#39;LTRB&#39;</span>
                <span class="n">b</span>      <span class="o">=</span> <span class="s1">&#39;LRT&#39;</span>
                <span class="n">b2</span>     <span class="o">=</span> <span class="s1">&#39;LR&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span> <span class="n">b2</span> <span class="o">+=</span> <span class="s1">&#39;L&#39;</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span> <span class="n">b2</span> <span class="o">+=</span> <span class="s1">&#39;R&#39;</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">+</span> <span class="s1">&#39;T&#39;</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span>

        <span class="n">character_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">]</span>
        <span class="n">text_cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">i</span>   <span class="o">=</span> <span class="mi">0</span>
        <span class="n">j</span>   <span class="o">=</span> <span class="mi">0</span>
        <span class="n">l</span>   <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ns</span>  <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nl</span>  <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">normalized_string_length</span><span class="p">):</span>
            <span class="c1"># Get next character</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Explicit line break</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0 Tw&#39;</span><span class="p">)</span>

                <span class="n">new_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span>
                                     <span class="n">border</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="n">align</span><span class="p">,</span>
                                     <span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="p">)</span>
                <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="n">page_break_triggered</span> <span class="ow">or</span> <span class="n">new_page</span>
                <span class="n">text_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span>

                <span class="n">i</span>   <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">sep</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">j</span>    <span class="o">=</span> <span class="n">i</span>
                <span class="n">l</span>    <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ns</span>   <span class="o">=</span> <span class="mi">0</span>
                <span class="n">nl</span>  <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">border</span> <span class="ow">and</span> <span class="n">nl</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">):</span>
                <span class="n">sep</span>  <span class="o">=</span> <span class="n">i</span>
                <span class="n">ls</span>   <span class="o">=</span> <span class="n">l</span>
                <span class="n">ns</span>  <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">*</span> <span class="mf">1000.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">+=</span> <span class="n">character_widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Automatic line break</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">wmax</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sep</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">):</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0 Tw&#39;</span><span class="p">)</span>

                    <span class="n">new_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span>
                                         <span class="n">border</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="n">align</span><span class="p">,</span>
                                         <span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="p">)</span>
                    <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="n">page_break_triggered</span> <span class="ow">or</span> <span class="n">new_page</span>
                    <span class="n">text_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">align</span> <span class="o">==</span> <span class="s1">&#39;J&#39;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">ns</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="p">((</span><span class="n">wmax</span> <span class="o">-</span> <span class="n">ls</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">/</span> <span class="p">(</span><span class="n">ns</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> Tw&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

                    <span class="n">new_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">sep</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span>
                              <span class="n">border</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="n">align</span><span class="p">,</span>
                              <span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="p">)</span>
                    <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="n">page_break_triggered</span> <span class="ow">or</span> <span class="n">new_page</span>
                    <span class="n">text_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">sep</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span>

                    <span class="n">i</span> <span class="o">=</span> <span class="n">sep</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">sep</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">j</span>    <span class="o">=</span> <span class="n">i</span>
                <span class="n">l</span>    <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ns</span>   <span class="o">=</span> <span class="mi">0</span>
                <span class="n">nl</span>  <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">border</span> <span class="ow">and</span> <span class="n">nl</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Last chunk</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0 Tw&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">border</span> <span class="ow">and</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">border</span><span class="p">):</span>
            <span class="n">b</span> <span class="o">+=</span> <span class="s1">&#39;B&#39;</span>

        <span class="n">new_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span>
                             <span class="n">border</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">ln</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="n">align</span><span class="p">,</span>
                             <span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="p">)</span>
        <span class="n">page_break_triggered</span> <span class="o">=</span> <span class="n">page_break_triggered</span> <span class="ow">or</span> <span class="n">new_page</span>
        <span class="n">text_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span>

        <span class="n">location_options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">:</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span><span class="p">),</span>  <span class="c1"># could control y</span>
            <span class="mi">2</span><span class="p">:</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">None</span>
        <span class="p">}</span>
        <span class="n">location_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">None</span><span class="p">)()</span>

        <span class="k">if</span> <span class="n">split_only</span><span class="p">:</span>
            <span class="c1"># restore writing functions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span> <span class="o">=</span> <span class="n">_out</span><span class="p">,</span> <span class="n">_add_page</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="o">*</span><span class="n">location</span><span class="p">)</span>  <span class="c1"># restore location</span>
            <span class="k">return</span> <span class="n">text_cells</span>

        <span class="k">return</span> <span class="n">page_break_triggered</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="s2">&quot;Output text in flowing mode&quot;</span>
        <span class="n">txt</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">cw</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">]</span>
        <span class="n">w</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">wmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
        <span class="n">s</span>    <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">nb</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">sep</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">i</span>    <span class="o">=</span> <span class="mi">0</span>
        <span class="n">j</span>    <span class="o">=</span> <span class="mi">0</span>
        <span class="n">l</span>    <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nl</span>   <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">nb</span><span class="p">):</span>
            <span class="c1"># Get next character</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="c1"># Explicit line break</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                <span class="n">i</span>   <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">sep</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">j</span>    <span class="o">=</span> <span class="n">i</span>
                <span class="n">l</span>    <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nl</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
                    <span class="n">w</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
                    <span class="n">wmax</span>   <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
                <span class="n">nl</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">):</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">*</span> <span class="mf">1000.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">+=</span> <span class="n">cw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">wmax</span><span class="p">):</span>
                <span class="c1"># Automatic line break</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">sep</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span><span class="p">):</span>
                        <span class="c1"># Move to next line</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">x</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">h</span>
                        <span class="n">w</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
                        <span class="n">wmax</span> <span class="o">=</span> <span class="p">((</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span><span class="p">)</span> <span class="o">*</span>
                                <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">)</span>
                        <span class="n">i</span>    <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">nl</span>   <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">):</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span>   <span class="o">-</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">sep</span> <span class="o">-</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">sep</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">j</span>   <span class="o">=</span> <span class="n">i</span>
                <span class="n">l</span>   <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nl</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
                    <span class="n">w</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
                    <span class="n">wmax</span>   <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
                <span class="n">nl</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Last chunk</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">l</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                      <span class="n">h</span><span class="p">,</span> <span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>  <span class="c1"># noqa: E501</span>
        <span class="s2">&quot;Put an image on the page&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">:</span>
            <span class="c1"># First use of image, get info</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">pos</span><span class="p">):</span>
                    <span class="n">fpdf_error</span><span class="p">((</span><span class="s1">&#39;image file has no extension and no &#39;</span>
                                <span class="s1">&#39;type was specified: &#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">))</span>
                <span class="nb">type</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="nb">type</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">image_is_jpeg</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;jpg&#39;</span> <span class="ow">or</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;jpeg&#39;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">image_is_jpeg</span><span class="p">()):</span> <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsejpg</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;png&#39;</span><span class="p">):</span> <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsepng</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Allow for additional formats</span>
                <span class="c1"># maybe the image is not showing the correct extension,</span>
                <span class="c1"># but the header is OK,</span>
                <span class="n">succeed_parsing</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="c1"># try all the parsing functions</span>
                <span class="n">parsing_functions</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parsejpg</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parsepng</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parsegif</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">parsing_functions</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">info</span> <span class="o">=</span> <span class="n">pf</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                        <span class="n">succeed_parsing</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="k">break</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="c1"># last resource</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">succeed_parsing</span><span class="p">:</span>
                    <span class="n">mtd</span> <span class="o">=</span> <span class="s1">&#39;_parse&#39;</span> <span class="o">+</span> <span class="nb">type</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">):</span>
                        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Unsupported image type: &#39;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">)</span>
                    <span class="n">info</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">)(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">mtd</span> <span class="o">=</span> <span class="s1">&#39;_parse&#39;</span> <span class="o">+</span> <span class="nb">type</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">):</span>
                    <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Unsupported image type: &#39;</span> <span class="o">+</span> <span class="nb">type</span><span class="p">)</span>
                <span class="n">info</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">)(</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># print info[&#39;i&#39;]</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="c1"># Automatic width and height calculation if needed</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># Put image at 72 dpi</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]</span>

        <span class="c1"># Flowing mode</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_break_trigger</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">accept_page_break</span><span class="p">):</span>
                <span class="c1"># Automatic page break</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span><span class="p">(</span><span class="n">same</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">h</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;q </span><span class="si">%.2f</span><span class="s1"> 0 0 </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> cm /I</span><span class="si">%d</span><span class="s1"> Do Q&#39;</span><span class="p">,</span>
                          <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">h</span>                  <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                          <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                          <span class="n">info</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">link</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>

    <span class="nd">@check_page</span>
    <span class="k">def</span> <span class="nf">ln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Line Feed; default value is last cell height&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
        <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lasth</span>
        <span class="k">else</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">h</span>

    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Get x position&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>

    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="s2">&quot;Set x position&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Get y position&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>

    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="s2">&quot;Set y position and reset x&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="s2">&quot;Set x and y positions&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Output PDF to some destination</span>

<span class="sd">        By default the PDF is written to sys.stdout. If a name is given, the</span>
<span class="sd">        PDF is written to a new file. If dest=&#39;S&#39; is given, the PDF data is</span>
<span class="sd">        returned as a byte string.&quot;&quot;&quot;</span>

        <span class="c1"># Finish document if necessary</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">dest</span>                      <span class="o">=</span> <span class="n">dest</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
            <span class="k">else</span><span class="p">:</span>            <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>

        <span class="k">if</span> <span class="n">PY3K</span><span class="p">:</span>
            <span class="c1"># manage binary data as latin1 until PEP461 or similar is</span>
            <span class="c1"># implemented</span>
            <span class="nb">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span>
        <span class="k">if</span> <span class="n">dest</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span>
            <span class="c1"># Python &lt; 3 writes byte data transparently without &quot;buffer&quot;</span>
            <span class="n">stdout</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="s1">&#39;buffer&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
            <span class="c1"># Save to local file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
        <span class="c1"># Return as a byte string</span>
        <span class="k">elif</span> <span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="nb">buffer</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect output destination: &#39;</span> <span class="o">+</span> <span class="n">dest</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalize_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">):</span>
        <span class="s2">&quot;Check that text input is in the correct format/encoding&quot;</span>
        <span class="c1"># - for TTF unicode fonts: unicode object (utf8 encoding)</span>
        <span class="c1"># - for built-in fonts: string instances (encoding: latin-1, cp1252)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;latin-1&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">txt</span>

    <span class="k">def</span> <span class="nf">_putpages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;str_alias_nb_pages&#39;</span><span class="p">):</span>
            <span class="c1"># Replace number of pages in fonts using subsets (unicode)</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_alias_nb_pages</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">UTF8ToUTF16BE</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nb</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="c1"># Now repeat for no pages in non-subset fonts</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> \
                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_alias_nb_pages</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
            <span class="n">dw_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dw_pt</span>
            <span class="n">dh_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_pt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dw_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_pt</span>
            <span class="n">dh_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dw_pt</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compress</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="s1">&#39;/Filter /FlateDecode &#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Page</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Page&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Parent 1 0 R&#39;</span><span class="p">)</span>
            <span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;w_pt&quot;</span><span class="p">]</span>
            <span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;h_pt&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">w_pt</span> <span class="o">!=</span> <span class="n">dw_pt</span> <span class="ow">or</span> <span class="n">h_pt</span> <span class="o">!=</span> <span class="n">dh_pt</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;/MediaBox [0 0 </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="n">w_pt</span><span class="p">,</span> <span class="n">h_pt</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Resources 2 0 R&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">:</span>
                <span class="c1"># Links</span>
                <span class="n">annots</span> <span class="o">=</span> <span class="s1">&#39;/Annots [&#39;</span>
                <span class="k">for</span> <span class="n">pl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                    <span class="n">rect</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pl</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pl</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pl</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="n">annots</span> <span class="o">+=</span> <span class="s1">&#39;&lt;&lt;/Type /Annot /Subtype /Link /Rect [&#39;</span> <span class="o">+</span> \
                              <span class="n">rect</span> <span class="o">+</span> <span class="s1">&#39;] /Border [0 0 0] &#39;</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pl</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">basestring</span><span class="p">):</span>
                        <span class="n">annots</span> <span class="o">+=</span> <span class="s1">&#39;/A &lt;&lt;/S /URI /URI &#39;</span> <span class="o">+</span> \
                                  <span class="n">enclose_in_parens</span><span class="p">(</span><span class="n">pl</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&gt;&gt;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">pl</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
                        <span class="c1"># if l[0] in self.orientation_changes: h = w_pt</span>
                        <span class="c1"># else:                                h = h_pt</span>
                        <span class="n">h</span> <span class="o">=</span> <span class="n">h_pt</span>
                        <span class="n">annots</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;/Dest [</span><span class="si">%d</span><span class="s1"> 0 R /XYZ 0 </span><span class="si">%.2f</span><span class="s1"> null]&gt;&gt;&#39;</span><span class="p">,</span>
                                          <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h</span> <span class="o">-</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">annots</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">&gt;</span> <span class="s1">&#39;1.3&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s2">&quot;/Group &lt;&lt;/Type /Group /S /Transparency&quot;</span>
                          <span class="s2">&quot;/CS /DeviceRGB&gt;&gt;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Contents &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&gt;&gt;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

            <span class="c1"># Page content</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compress</span><span class="p">:</span>
                <span class="c1"># manage binary data as latin1 until PEP461 or similar is</span>
                <span class="c1"># implemented</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">PY3K</span> <span class="k">else</span> <span class="n">content</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">content</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span> <span class="o">+</span> <span class="nb">filter</span> <span class="o">+</span> <span class="s1">&#39;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>
        <span class="c1"># Pages root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;1 0 obj&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Pages&#39;</span><span class="p">)</span>
        <span class="n">kids</span> <span class="o">=</span> <span class="s1">&#39;/Kids [&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span> <span class="n">kids</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R &#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">kids</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Count &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;/MediaBox [0 0 </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="n">dw_pt</span><span class="p">,</span> <span class="n">dh_pt</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putfonts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">diff</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">:</span>
            <span class="c1"># Encodings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">((</span><span class="s1">&#39;&lt;&lt;/Type /Encoding /BaseEncoding /WinAnsiEncoding &#39;</span> <span class="o">+</span>
                       <span class="s1">&#39;/Differences [&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">[</span><span class="n">diff</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&gt;&gt;&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">info</span> <span class="ow">and</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;TTF&#39;</span><span class="p">:</span>
                <span class="c1"># Font file embedding</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">compressed</span> <span class="o">=</span> <span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;.z&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">compressed</span> <span class="ow">and</span> <span class="s1">&#39;length2&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">):</span>
                    <span class="n">header</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">128</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">header</span><span class="p">):</span>
                        <span class="c1"># Strip first binary header</span>
                        <span class="n">font</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">header</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length1&#39;</span><span class="p">]])</span> <span class="o">==</span> <span class="mi">128</span><span class="p">):</span>
                        <span class="c1"># Strip second binary header</span>
                        <span class="n">font</span> <span class="o">=</span> <span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;length1&#39;</span><span class="p">])</span> <span class="o">+</span>
                                <span class="n">substr</span><span class="p">(</span><span class="n">font</span><span class="p">,</span>    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;length1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Length &#39;</span>    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">font</span><span class="p">)))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">compressed</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Filter /FlateDecode&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Length1 &#39;</span>     <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length1&#39;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;length2&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Length2 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;length2&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; /Length3 0&#39;</span><span class="p">)</span>  <span class="c1"># noqa: E501</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

        <span class="c1"># Font objects</span>
        <span class="n">flist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;i&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">flist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">flist</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">my_type</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="c1"># Standard font</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">my_type</span> <span class="o">==</span> <span class="s1">&#39;core&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Font&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/BaseFont /&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Subtype /Type1&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;Symbol&#39;</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;ZapfDingbats&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Encoding /WinAnsiEncoding&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

            <span class="c1"># Additional Type1 or TrueType font</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">my_type</span> <span class="o">==</span> <span class="s1">&#39;Type1&#39;</span> <span class="ow">or</span> <span class="n">my_type</span> <span class="o">==</span> <span class="s1">&#39;TrueType&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Font&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/BaseFont /&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Subtype /&#39;</span> <span class="o">+</span> <span class="n">my_type</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/FirstChar 32 /LastChar 255&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Widths &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/FontDescriptor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;enc&#39;</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;diff&#39;</span> <span class="ow">in</span> <span class="n">font</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Encoding &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nf</span> <span class="o">+</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>  <span class="c1"># noqa: E501</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Encoding /WinAnsiEncoding&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># Widths</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="n">cw</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">]</span>
                <span class="n">s</span>  <span class="o">=</span> <span class="s1">&#39;[&#39;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
                    <span class="c1"># Get doesn&#39;t raise exception;</span>
                    <span class="c1"># returns 0 instead of None if not set</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># Descriptor</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&lt;&lt;/Type /FontDescriptor /FontName /&#39;</span> <span class="o">+</span> <span class="n">name</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Ascent&#39;</span><span class="p">,</span> <span class="s1">&#39;Descent&#39;</span><span class="p">,</span> <span class="s1">&#39;CapHeight&#39;</span><span class="p">,</span> <span class="s1">&#39;Flags&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;FontBBox&#39;</span><span class="p">,</span> <span class="s1">&#39;ItalicAngle&#39;</span><span class="p">,</span> <span class="s1">&#39;StemV&#39;</span><span class="p">,</span> <span class="s1">&#39;MissingWidth&#39;</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; /</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>

                <span class="n">filename</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; /FontFile&#39;</span>
                    <span class="k">if</span> <span class="n">my_type</span> <span class="o">!=</span> <span class="s1">&#39;Type1&#39;</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;2&#39;</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">filename</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">my_type</span> <span class="o">==</span> <span class="s1">&#39;TTF&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">ttf</span> <span class="o">=</span> <span class="n">TTFontFile</span><span class="p">()</span>
                <span class="n">fontname</span>     <span class="o">=</span> <span class="s1">&#39;MPDFAA&#39;</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span> <span class="o">+</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">subset</span>       <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ttfontstream</span> <span class="o">=</span> <span class="n">ttf</span><span class="o">.</span><span class="n">makeSubset</span><span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;ttffile&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">)</span>
                <span class="n">ttfontsize</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ttfontstream</span><span class="p">)</span>
                <span class="n">fontstream</span>   <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">ttfontstream</span><span class="p">)</span>
                <span class="n">codeToGlyph</span>  <span class="o">=</span> <span class="n">ttf</span><span class="o">.</span><span class="n">codeToGlyph</span>
                <span class="c1"># del codeToGlyph[0]</span>

                <span class="c1"># Type0 Font</span>
                <span class="c1"># A composite font - a font composed of other fonts,</span>
                <span class="c1"># organized hierarchically</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Font&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Subtype /Type0&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/BaseFont /&#39;</span> <span class="o">+</span> <span class="n">fontname</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Encoding /Identity-H&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/DescendantFonts [&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/ToUnicode &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># CIDFontType2</span>
                <span class="c1"># A CIDFont whose glyph descriptions are based on</span>
                <span class="c1"># TrueType font technology</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /Font&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Subtype /CIDFontType2&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/BaseFont /&#39;</span> <span class="o">+</span> <span class="n">fontname</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/CIDSystemInfo &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/FontDescriptor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/DW </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putTTfontwidths</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">ttf</span><span class="o">.</span><span class="n">maxUni</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/CIDToGIDMap &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># ToUnicode</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="n">toUni</span> <span class="o">=</span> <span class="s2">&quot;/CIDInit /ProcSet findresource begin</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;12 dict begin</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;begincmap</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;/CIDSystemInfo</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;&lt;&lt;/Registry (Adobe)</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;/Ordering (UCS)</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;/Supplement 0</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;&gt;&gt; def</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;/CMapName /Adobe-Identity-UCS def</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;/CMapType 2 def</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;1 begincodespacerange</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;&lt;0000&gt; &lt;FFFF&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;endcodespacerange</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;1 beginbfrange</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;&lt;0000&gt; &lt;FFFF&gt; &lt;0000&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;endbfrange</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;endcmap</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;CMapName currentdict /CMap defineresource pop</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;end</span><span class="se">\n</span><span class="s2">&quot;</span> \
                        <span class="s2">&quot;end&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toUni</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">toUni</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># CIDSystemInfo dictionary</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Registry (Adobe)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Ordering (UCS)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Supplement 0&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># Font descriptor</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /FontDescriptor&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/FontName /&#39;</span> <span class="o">+</span> <span class="n">fontname</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">kd</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Ascent&#39;</span><span class="p">,</span> <span class="s1">&#39;Descent&#39;</span><span class="p">,</span> <span class="s1">&#39;CapHeight&#39;</span><span class="p">,</span> <span class="s1">&#39;Flags&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;FontBBox&#39;</span><span class="p">,</span> <span class="s1">&#39;ItalicAngle&#39;</span><span class="p">,</span> <span class="s1">&#39;StemV&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;MissingWidth&#39;</span><span class="p">):</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="n">kd</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">kd</span> <span class="o">==</span> <span class="s1">&#39;Flags&#39;</span><span class="p">):</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">|</span> <span class="mi">4</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mi">32</span>  <span class="c1"># SYMBOLIC font flag</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39; /</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kd</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/FontFile2 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># Embed CIDToGIDMap</span>
                <span class="c1"># A specification of the mapping from CIDs to glyph indices</span>
                <span class="n">cidtogidmap</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">cidtogidmap</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">glyph</span> <span class="ow">in</span> <span class="n">codeToGlyph</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">cidtogidmap</span><span class="p">[</span><span class="n">cc</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">glyph</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span>
                    <span class="n">cidtogidmap</span><span class="p">[</span><span class="n">cc</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">glyph</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
                <span class="n">cidtogidmap</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cidtogidmap</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">PY3K</span><span class="p">:</span>
                    <span class="c1"># manage binary data as latin1 until PEP461-like function</span>
                    <span class="c1"># is implemented</span>
                    <span class="n">cidtogidmap</span> <span class="o">=</span> <span class="n">cidtogidmap</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>
                <span class="n">cidtogidmap</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">cidtogidmap</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cidtogidmap</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Filter /FlateDecode&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">cidtogidmap</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

                <span class="c1"># Font file</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fontstream</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Filter /FlateDecode&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Length1 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ttfontsize</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">fontstream</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">ttf</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Allow for additional types</span>
                <span class="n">mtd</span> <span class="o">=</span> <span class="s1">&#39;_put&#39;</span> <span class="o">+</span> <span class="n">my_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="c1"># check if self has a attr mtd which is callable (method)</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mtd</span><span class="p">,</span> <span class="bp">None</span><span class="p">))):</span>
                    <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Unsupported font type: &#39;</span> <span class="o">+</span> <span class="n">my_type</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mtd</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putTTfontwidths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">maxUni</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;unifilename&#39;</span><span class="p">]:</span>
            <span class="n">ops</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span>
            <span class="n">cw127fname</span> <span class="o">=</span> <span class="n">ops</span><span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;unifilename&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.cw127.pkl&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cw127fname</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">font_dict</span> <span class="o">=</span> <span class="n">load_cache</span><span class="p">(</span><span class="n">cw127fname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">font_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rangeid</span>        <span class="o">=</span> <span class="mi">0</span>
            <span class="n">range_</span>         <span class="o">=</span> <span class="p">{}</span>
            <span class="n">range_interval</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">prevcid</span>        <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="n">prevwidth</span>      <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">interval</span>       <span class="o">=</span> <span class="bp">False</span>
            <span class="n">startcid</span>       <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rangeid</span>        <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;rangeid&#39;</span><span class="p">]</span>
            <span class="n">range_</span>         <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">]</span>
            <span class="n">prevcid</span>        <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;prevcid&#39;</span><span class="p">]</span>
            <span class="n">prevwidth</span>      <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;prevwidth&#39;</span><span class="p">]</span>
            <span class="n">interval</span>       <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;interval&#39;</span><span class="p">]</span>
            <span class="n">range_interval</span> <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;range_interval&#39;</span><span class="p">]</span>
            <span class="n">startcid</span>       <span class="o">=</span> <span class="mi">128</span>
        <span class="n">cwlen</span> <span class="o">=</span> <span class="n">maxUni</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># for each character</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">startcid</span><span class="p">,</span> <span class="n">cwlen</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">128</span> <span class="ow">and</span> <span class="n">cw127fname</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cw127fname</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cw127fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                        <span class="n">font_dict</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;rangeid&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">rangeid</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;prevcid&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">prevcid</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;prevwidth&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">prevwidth</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;interval&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="n">interval</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;range_interval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_interval</span>
                        <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="n">range_</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">font_dict</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">:</span>
                        <span class="k">raise</span>  <span class="c1"># Not a permission error.</span>

            <span class="k">if</span> <span class="n">cid</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">):</span> <span class="k">continue</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">][</span><span class="n">cid</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="mi">65535</span><span class="p">):</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;dw&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">font</span> <span class="ow">or</span> <span class="p">(</span><span class="n">font</span><span class="p">[</span><span class="s1">&#39;dw&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">width</span> <span class="o">!=</span> <span class="n">font</span><span class="p">[</span><span class="s1">&#39;dw&#39;</span><span class="p">])):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">cid</span> <span class="o">==</span> <span class="p">(</span><span class="n">prevcid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="n">prevwidth</span><span class="p">):</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">==</span> <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="n">range_</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">rangeid</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                            <span class="c1"># new range</span>
                            <span class="n">rangeid</span> <span class="o">=</span> <span class="n">prevcid</span>
                            <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">prevwidth</span><span class="p">,</span> <span class="n">width</span><span class="p">]</span>
                        <span class="n">interval</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="n">range_interval</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">):</span>
                            <span class="c1"># new range</span>
                            <span class="n">rangeid</span> <span class="o">=</span> <span class="n">cid</span>
                            <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">width</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
                        <span class="n">interval</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rangeid</span> <span class="o">=</span> <span class="n">cid</span>
                    <span class="n">range_</span><span class="p">[</span><span class="n">rangeid</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">width</span><span class="p">]</span>
                    <span class="n">interval</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">prevcid</span> <span class="o">=</span> <span class="n">cid</span>
                <span class="n">prevwidth</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">prevk</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">nextk</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">prevint</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">ri</span> <span class="o">=</span> <span class="n">range_interval</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ws</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">range_</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">cws</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="n">nextk</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prevint</span> <span class="ow">and</span> <span class="p">(</span><span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ri</span> <span class="ow">or</span> <span class="n">cws</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">ri</span><span class="p">):</span>
                    <span class="k">del</span> <span class="n">ri</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">range_</span><span class="p">[</span><span class="n">prevk</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_</span><span class="p">[</span><span class="n">prevk</span><span class="p">]</span> <span class="o">+</span> <span class="n">range_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">range_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prevk</span> <span class="o">=</span> <span class="n">k</span>
            <span class="n">nextk</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">cws</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">ri</span><span class="p">):</span>
                <span class="n">prevint</span> <span class="o">=</span> <span class="p">(</span><span class="n">cws</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">ri</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">nextk</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prevint</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ws</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">range_</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ws</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> [ </span><span class="si">%s</span><span class="s1"> ]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                         <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/W [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_putimages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compress</span> <span class="k">else</span> <span class="s1">&#39;/Filter /FlateDecode &#39;</span>   <span class="c1"># noqa: F841</span>

        <span class="n">i</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;i&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">i</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_putimage</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;smask&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;smask&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_putimage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;data&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;/Type /XObject&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Subtype /Image&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Width &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Height &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;cs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Indexed&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/ColorSpace [/Indexed /DeviceRGB &#39;</span>  <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;pal&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R]&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/ColorSpace /&#39;</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;cs&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;cs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DeviceCMYK&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Decode [1 0 1 0 1 0 1 0]&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/BitsPerComponent &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bpc&#39;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="s1">&#39;f&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Filter /&#39;</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;dp&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/DecodeParms &lt;&lt;&#39;</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;dp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;trns&#39;</span> <span class="ow">in</span> <span class="n">info</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;trns&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="n">trns</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;trns&#39;</span><span class="p">])):</span>
                    <span class="n">trns</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;trns&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;trns&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Mask [&#39;</span> <span class="o">+</span> <span class="n">trns</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;smask&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/SMask &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

            <span class="c1"># Soft mask</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;smask&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">):</span>
                <span class="n">dp</span> <span class="o">=</span> <span class="s1">&#39;/Predictor 15 /Colors 1 /BitsPerComponent 8 &#39;</span> <span class="o">+</span> \
                     <span class="s1">&#39;/Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">])</span>
                <span class="n">smask</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;w&#39;</span>    <span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">],</span>    <span class="s1">&#39;h&#39;</span>    <span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;cs&#39;</span>   <span class="p">:</span> <span class="s1">&#39;DeviceGray&#39;</span><span class="p">,</span> <span class="s1">&#39;bpc&#39;</span>  <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="s1">&#39;f&#39;</span>    <span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">],</span>    <span class="s1">&#39;dp&#39;</span>   <span class="p">:</span> <span class="n">dp</span><span class="p">,</span>
                    <span class="s1">&#39;data&#39;</span> <span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;smask&#39;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putimage</span><span class="p">(</span><span class="n">smask</span><span class="p">)</span>

            <span class="c1"># Palette</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;cs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Indexed&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
                <span class="nb">filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compress</span> <span class="ow">and</span> <span class="s1">&#39;/Filter /FlateDecode &#39;</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compress</span><span class="p">:</span>
                    <span class="n">pal</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;pal&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pal</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;pal&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span> <span class="o">+</span> <span class="nb">filter</span> <span class="o">+</span> <span class="s1">&#39;/Length &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pal</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_putstream</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putxobjectdict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">i</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/I&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putresourcedict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Font &lt;&lt;&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/F&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/XObject &lt;&lt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putxobjectdict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putresources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putfonts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putimages</span><span class="p">()</span>

        <span class="c1"># Resource dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;2 0 obj&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putresourcedict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">enclose_in_parens</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">so</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span>

        <span class="c1"># so(&#39;/Producer &#39; + ts(&#39;PyFPDF &#39; + FPDF_VERSION + \</span>
        <span class="c1">#    &#39; http://pyfpdf.googlecode.com/&#39;))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">):</span>    <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/Title &#39;</span>    <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">):</span>  <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/Subject &#39;</span>  <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subject</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">):</span>   <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/Author &#39;</span>   <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">):</span> <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/Keywords &#39;</span> <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;creator&#39;</span><span class="p">):</span>  <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/Creator &#39;</span>  <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">creator</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;creation_date&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">creation_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span>
                <span class="n">date_string</span> <span class="o">=</span> <span class="n">creation_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Could not format date: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">creation_date</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">date_string</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S&#39;</span><span class="p">)</span>
        <span class="n">so</span><span class="p">(</span><span class="s1">&#39;/CreationDate &#39;</span> <span class="o">+</span> <span class="n">ts</span><span class="p">(</span><span class="s1">&#39;D:&#39;</span> <span class="o">+</span> <span class="n">date_string</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_putcatalog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Type /Catalog&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Pages 1 0 R&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">==</span> <span class="s1">&#39;fullpage&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/OpenAction [3 0 R /Fit]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">==</span> <span class="s1">&#39;fullwidth&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/OpenAction [3 0 R /FitH null]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">==</span> <span class="s1">&#39;real&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/OpenAction [3 0 R /XYZ null null 1]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;/OpenAction [3 0 R /XYZ null null </span><span class="si">%s</span><span class="s1">]&#39;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout_mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/PageLayout /SinglePage&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/PageLayout /OneColumn&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout_mode</span> <span class="o">==</span> <span class="s1">&#39;two&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/PageLayout /TwoColumnLeft&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_putheader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;%PDF-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_puttrailer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Size &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Root &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>     <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;/Info &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 R&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_enddoc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putheader</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putpages</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putresources</span><span class="p">()</span>
        <span class="c1"># Info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putinfo</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>
        <span class="c1"># Catalog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_newobj</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_putcatalog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endobj&#39;</span><span class="p">)</span>
        <span class="c1"># Cross-ref</span>
        <span class="n">o</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;xref&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0 &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;0000000000 65535 f &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%010d</span><span class="s1"> 00000 n &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="c1"># Trailer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;trailer&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_puttrailer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;startxref&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%%</span><span class="s1">EOF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">_beginpage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">same</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page</span>             <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span>             <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span>                 <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span>                 <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>       <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span>   <span class="o">=</span> <span class="mi">100</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">same</span><span class="p">:</span>
            <span class="c1"># Page format</span>
            <span class="k">if</span> <span class="n">format</span><span class="p">:</span>
                <span class="c1"># Change page format</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">=</span> <span class="n">get_page_format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Set to default format</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dw_pt</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dh_pt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="c1"># Page orientation</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">orientation</span><span class="p">:</span>
                <span class="n">orientation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur_orientation</span> <span class="o">=</span> <span class="n">orientation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page_break_trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_margin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cur_orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">][</span><span class="s2">&quot;w_pt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">][</span><span class="s2">&quot;h_pt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span>

    <span class="k">def</span> <span class="nf">_endpage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># End of page contents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_newobj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Begin a new object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; 0 obj&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_dounderline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span><span class="p">):</span>
        <span class="c1"># Underline text</span>
        <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span>
        <span class="n">ut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;ut&#39;</span><span class="p">]</span>
        <span class="n">w</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string_width</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">*</span> <span class="n">txt</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> re f&#39;</span><span class="p">,</span>
                       <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                       <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">up</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                       <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                       <span class="o">-</span><span class="n">ut</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parsejpg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c1"># Extract info from a JPEG file</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">image_parsing_load_resource</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">get_jpg_info</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parsegif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c1"># Extract info from a GIF file (via PNG conversion)</span>
        <span class="k">if</span> <span class="n">Image</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;PIL is required for GIF support&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Missing or incorrect image file: </span><span class="si">%s</span><span class="s1">. error: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                       <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use temporary file</span>
            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                                             <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="s2">&quot;transparency&quot;</span> <span class="ow">in</span> <span class="n">im</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
                <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">transparency</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;transparency&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsepng</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">_parsepng</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c1"># Extract info from a PNG file</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">image_parsing_load_resource</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        
        <span class="n">info</span> <span class="o">=</span> <span class="n">get_png_info</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;smask&#39;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="s1">&#39;1.4&#39;</span>

        <span class="k">return</span> <span class="n">info</span>

    <span class="k">def</span> <span class="nf">_putstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;stream&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;endstream&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="c1"># Add a line to the document</span>
        <span class="k">if</span> <span class="n">PY3K</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="c1"># manage binary data as latin1 until PEP461-like function is</span>
            <span class="c1"># implemented</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">PY3K</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="c1"># default encoding (font name and similar)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#fpdf.FPDF">FPDF</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="fpdf.FPDF.accept_page_break" class="name">var <span class="ident">accept_page_break</span></p>
            

            
  
    <div class="desc"><p>Accept automatic page break or not</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.angle" class="name">var <span class="ident">angle</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.buffer" class="name">var <span class="ident">buffer</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.c_margin" class="name">var <span class="ident">c_margin</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.color_flag" class="name">var <span class="ident">color_flag</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.core_fonts" class="name">var <span class="ident">core_fonts</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.core_fonts_encoding" class="name">var <span class="ident">core_fonts_encoding</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.cur_orientation" class="name">var <span class="ident">cur_orientation</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.dh_pt" class="name">var <span class="ident">dh_pt</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.diffs" class="name">var <span class="ident">diffs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.draw_color" class="name">var <span class="ident">draw_color</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.dw_pt" class="name">var <span class="ident">dw_pt</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.fh" class="name">var <span class="ident">fh</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.fill_color" class="name">var <span class="ident">fill_color</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.font_family" class="name">var <span class="ident">font_family</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.font_files" class="name">var <span class="ident">font_files</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.font_size_pt" class="name">var <span class="ident">font_size_pt</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.font_stretching" class="name">var <span class="ident">font_stretching</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.font_style" class="name">var <span class="ident">font_style</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.fonts" class="name">var <span class="ident">fonts</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.fw" class="name">var <span class="ident">fw</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.h" class="name">var <span class="ident">h</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.images" class="name">var <span class="ident">images</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.in_footer" class="name">var <span class="ident">in_footer</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.lasth" class="name">var <span class="ident">lasth</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.lastw" class="name">var <span class="ident">lastw</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.line_width" class="name">var <span class="ident">line_width</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.links" class="name">var <span class="ident">links</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.n" class="name">var <span class="ident">n</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.offsets" class="name">var <span class="ident">offsets</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.page" class="name">var <span class="ident">page</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.page_links" class="name">var <span class="ident">page_links</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.pages" class="name">var <span class="ident">pages</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.pdf_version" class="name">var <span class="ident">pdf_version</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.state" class="name">var <span class="ident">state</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.text_color" class="name">var <span class="ident">text_color</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.underline" class="name">var <span class="ident">underline</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.w" class="name">var <span class="ident">w</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.FPDF.ws" class="name">var <span class="ident">ws</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, orientation=&#39;P&#39;, unit=&#39;mm&#39;, format=&#39;A4&#39;)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.__init__', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;A4&#39;</span><span class="p">):</span>
    <span class="c1"># Initialization of properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="p">{}</span>               <span class="c1"># array of object offsets</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># current page number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>                      <span class="c1"># current object number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                <span class="c1"># buffer holding in-memory PDF</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array containing pages and metadata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># current document state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of used fonts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span> <span class="o">=</span> <span class="p">{}</span>            <span class="c1"># array of font files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of encoding differences</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>                <span class="c1"># array of used images</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span> <span class="o">=</span> <span class="p">{}</span>            <span class="c1"># array of links in pages</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">{}</span>                 <span class="c1"># array of internal links</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c1"># flag set when processing footer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lastw</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lasth</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># height of last cell printed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>           <span class="c1"># current font family</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>            <span class="c1"># current font style</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">=</span> <span class="mi">12</span>          <span class="c1"># current font size in points</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">=</span> <span class="mi">100</span>      <span class="c1"># current font stretching</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c1"># underlining flag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="s1">&#39;0 G&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="s1">&#39;0 g&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="s1">&#39;0 g&#39;</span>
    <span class="c1"># indicates whether fill and text colors are different</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># word spacing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Standard fonts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;courier&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier&#39;</span><span class="p">,</span> <span class="s1">&#39;courierB&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Bold&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;courierI&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Oblique&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;courierBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-BoldOblique&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;helvetica&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;helveticaB&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;helveticaI&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Oblique&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;helveticaBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-BoldOblique&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;times&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Roman&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;timesB&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Bold&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;timesI&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Italic&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;timesBI&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-BoldItalic&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Symbol&#39;</span><span class="p">,</span> <span class="s1">&#39;zapfdingbats&#39;</span><span class="p">:</span> <span class="s1">&#39;ZapfDingbats&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span> <span class="o">=</span> <span class="s2">&quot;latin-1&quot;</span>
    <span class="c1"># Scale factor</span>
    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;pt&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">72</span> <span class="o">/</span> <span class="mf">25.4</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;cm&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">72</span> <span class="o">/</span> <span class="mf">2.54</span>
    <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mf">72.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;Incorrect unit: &quot;</span> <span class="o">+</span> <span class="n">unit</span><span class="p">)</span>
    <span class="c1"># Page format</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">=</span> <span class="n">get_page_format</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dw_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dh_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="c1"># Page orientation</span>
    <span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
    <span class="k">elif</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fh_pt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fw_pt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect orientation: &#39;</span> <span class="o">+</span> <span class="n">orientation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cur_orientation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">def_orientation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="c1"># Page spacing</span>
    <span class="c1"># Page margins (1 cm)</span>
    <span class="n">margin</span> <span class="o">=</span> <span class="mf">28.35</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_margins</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c_margin</span> <span class="o">=</span> <span class="n">margin</span> <span class="o">/</span> <span class="mf">10.0</span>            <span class="c1"># Interior cell margin (1 mm)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="o">.</span><span class="mi">567</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>          <span class="c1"># line width (0.2 mm)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">)</span>  <span class="c1"># Automatic page break</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_display_mode</span><span class="p">(</span><span class="s1">&#39;fullwidth&#39;</span><span class="p">)</span>       <span class="c1"># Full width display mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_compression</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                  <span class="c1"># Enable compression</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdf_version</span> <span class="o">=</span> <span class="s1">&#39;1.3&#39;</span>                 <span class="c1"># Set default PDF version No.</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.add_font">
    <p>def <span class="ident">add_font</span>(</p><p>self, family, style=&#39;&#39;, fname=None, uni=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Add a TrueType or Type1 font</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.add_font', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.add_font" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">uni</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="s2">&quot;Add a TrueType or Type1 font&quot;</span>
    <span class="n">family</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="p">:</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;.pkl&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;arial&#39;</span><span class="p">):</span> <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;helvetica&#39;</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;IB&#39;</span><span class="p">):</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;BI&#39;</span>
    <span class="n">fontkey</span> <span class="o">=</span> <span class="n">family</span> <span class="o">+</span> <span class="n">style</span>
    <span class="c1"># Font already added!</span>
    <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">:</span> <span class="k">return</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">uni</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">FPDF_CACHE_MODE</span><span class="p">,</span> <span class="n">FPDF_CACHE_DIR</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
            <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">fname</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">FPDF_FONT_DIR</span> <span class="ow">and</span>
              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">fname</span><span class="p">))):</span>
            <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">SYSTEM_TTFONTS</span> <span class="ow">and</span>
              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">fname</span><span class="p">))):</span>
            <span class="n">ttffilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SYSTEM_TTFONTS</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;TTF Font file not found: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># noqa: F841</span>
        <span class="k">if</span> <span class="n">FPDF_CACHE_MODE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">unifilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.pkl&#39;</span>
        <span class="k">elif</span> <span class="n">FPDF_CACHE_MODE</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">unifilename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_CACHE_DIR</span><span class="p">,</span>
                <span class="n">hashpath</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.pkl&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unifilename</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">font_dict</span> <span class="o">=</span> <span class="n">load_cache</span><span class="p">(</span><span class="n">unifilename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">font_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ttf</span> <span class="o">=</span> <span class="n">TTFontFile</span><span class="p">()</span>
            <span class="n">ttf</span><span class="o">.</span><span class="n">getMetrics</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span>
            <span class="n">desc</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Ascent&#39;</span>       <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">ascent</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="s1">&#39;Descent&#39;</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">descent</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="s1">&#39;CapHeight&#39;</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">capHeight</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="s1">&#39;Flags&#39;</span>        <span class="p">:</span> <span class="n">ttf</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
                <span class="s1">&#39;FontBBox&#39;</span>     <span class="p">:</span> <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">))),</span>
                <span class="s1">&#39;ItalicAngle&#39;</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">italicAngle</span><span class="p">),</span>
                <span class="s1">&#39;StemV&#39;</span>        <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">stemV</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                <span class="s1">&#39;MissingWidth&#39;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">defaultWidth</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="p">}</span>
            <span class="c1"># Generate metrics .pkl file</span>
            <span class="n">font_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span>         <span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[ ()]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ttf</span><span class="o">.</span><span class="n">fullName</span><span class="p">),</span>
                <span class="s1">&#39;type&#39;</span>         <span class="p">:</span> <span class="s1">&#39;TTF&#39;</span><span class="p">,</span>
                <span class="s1">&#39;desc&#39;</span>         <span class="p">:</span> <span class="n">desc</span><span class="p">,</span>
                <span class="s1">&#39;up&#39;</span>           <span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">underlinePosition</span><span class="p">),</span>
                <span class="s1">&#39;ut&#39;</span>           <span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">ttf</span><span class="o">.</span><span class="n">underlineThickness</span><span class="p">),</span>
                <span class="s1">&#39;ttffile&#39;</span>      <span class="p">:</span> <span class="n">ttffilename</span><span class="p">,</span>
                <span class="s1">&#39;fontkey&#39;</span>      <span class="p">:</span> <span class="n">fontkey</span><span class="p">,</span>
                <span class="s1">&#39;originalsize&#39;</span> <span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">ttffilename</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span>
                <span class="s1">&#39;cw&#39;</span>           <span class="p">:</span> <span class="n">ttf</span><span class="o">.</span><span class="n">charWidths</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">unifilename</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unifilename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">font_dict</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EACCES</span><span class="p">:</span>
                        <span class="k">raise</span>  <span class="c1"># Not a permission error.</span>
            <span class="k">del</span> <span class="n">ttf</span>
        <span class="c1"># include numbers in the subset! (if alias present)</span>
        <span class="n">have_page_alias</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;str_alias_nb_pages&#39;</span><span class="p">)</span>
        <span class="n">sbarr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">57</span> <span class="k">if</span> <span class="n">have_page_alias</span><span class="p">()</span> <span class="k">else</span> <span class="mi">32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;i&#39;</span>           <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
            <span class="s1">&#39;name&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
            <span class="s1">&#39;desc&#39;</span>        <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">],</span>
            <span class="s1">&#39;up&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">],</span>
            <span class="s1">&#39;ut&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;ut&#39;</span><span class="p">],</span>
            <span class="s1">&#39;cw&#39;</span>          <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">],</span>
            <span class="s1">&#39;ttffile&#39;</span>     <span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;ttffile&#39;</span><span class="p">],</span>
            <span class="s1">&#39;fontkey&#39;</span>     <span class="p">:</span> <span class="n">fontkey</span><span class="p">,</span>
            <span class="s1">&#39;subset&#39;</span>      <span class="p">:</span> <span class="n">sbarr</span><span class="p">,</span>
            <span class="s1">&#39;unifilename&#39;</span> <span class="p">:</span> <span class="n">unifilename</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;originalsize&#39;</span><span class="p">],</span>
                                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s2">&quot;TTF&quot;</span><span class="p">,</span> <span class="s1">&#39;ttffile&#39;</span><span class="p">:</span> <span class="n">ttffilename</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">fname</span><span class="p">]</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s2">&quot;TTF&quot;</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fontfile</span><span class="p">:</span>
            <span class="n">font_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fontfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">font_dict</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">font_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">diff</span><span class="p">):</span>
            <span class="c1"># Search existing encodings</span>
            <span class="n">d</span>  <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">diff</span><span class="p">):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diffs</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">][</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">font_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TrueType&#39;</span><span class="p">):</span>
                <span class="n">originalsize</span> <span class="o">=</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;originalsize&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">originalsize</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">font_files</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;length1&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;size1&#39;</span><span class="p">],</span>
                                             <span class="s1">&#39;length2&#39;</span><span class="p">:</span> <span class="n">font_dict</span><span class="p">[</span><span class="s1">&#39;size2&#39;</span><span class="p">]}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.add_link">
    <p>def <span class="ident">add_link</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a new internal link</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.add_link', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.add_link" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_link</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Create a new internal link&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.add_page">
    <p>def <span class="ident">add_page</span>(</p><p>self, orientation=&#39;&#39;, format=&#39;&#39;, same=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Start a new page, if same page format will be same as previous</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.add_page', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.add_page" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">same</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="s2">&quot;Start a new page, if same page format will be same as previous&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
    <span class="n">family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>
    <span class="n">style</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">+</span> <span class="s1">&#39;U&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span>
    <span class="n">size</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>
    <span class="n">lw</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span>
    <span class="n">dc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span>
    <span class="n">fc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span>
    <span class="n">tc</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span>
    <span class="n">cf</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span>
    <span class="n">stretching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># Page footer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">footer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># close page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_endpage</span><span class="p">()</span>
    <span class="c1"># Start new page</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_beginpage</span><span class="p">(</span><span class="n">orientation</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">same</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="s1">&#39;2 J&#39;</span><span class="p">)</span>      <span class="c1"># Set line cap style to square</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">lw</span>  <span class="c1"># Set line width</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
    <span class="c1"># Set font</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">family</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="c1"># Set colors</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">dc</span>
    <span class="k">if</span> <span class="n">dc</span> <span class="o">!=</span> <span class="s1">&#39;0 G&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">fc</span>
    <span class="k">if</span> <span class="n">fc</span> <span class="o">!=</span> <span class="s1">&#39;0 g&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">tc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="n">cf</span>
    <span class="sd">&quot;&quot;&quot; BEGIN Page header &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">!=</span> <span class="n">lw</span><span class="p">):</span>                       <span class="c1"># Restore line width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">lw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">family</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>  <span class="c1"># Restore font</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">!=</span> <span class="n">dc</span><span class="p">):</span>                      <span class="c1"># Restore colors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">dc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="n">fc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">fc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">tc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="n">cf</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">stretching</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">):</span>                          <span class="c1"># Restore stretching</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_stretching</span><span class="p">(</span><span class="n">stretching</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot; END Page header &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.alias_nb_pages">
    <p>def <span class="ident">alias_nb_pages</span>(</p><p>self, alias=&#39;{nb}&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Define an alias for total number of pages</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.alias_nb_pages', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.alias_nb_pages" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alias_nb_pages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;{nb}&#39;</span><span class="p">):</span>
    <span class="s2">&quot;Define an alias for total number of pages&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">str_alias_nb_pages</span> <span class="o">=</span> <span class="n">alias</span>
    <span class="k">return</span> <span class="n">alias</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.cell">
    <p>def <span class="ident">cell</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Output a cell, return boolean if triggered auto page break</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.cell', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.cell" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.check_page">
    <p>def <span class="ident">check_page</span>(</p><p>fn)</p>
    </div>
    

    
  
    <div class="desc"><p>Decorator to protect drawing methods</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.check_page', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.check_page" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_page</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="s2">&quot;Decorator to protect drawing methods&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.close">
    <p>def <span class="ident">close</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Terminate document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.close', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.close" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Terminate document&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
    <span class="c1"># Page footer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">footer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_footer</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_endpage</span><span class="p">()</span>  <span class="c1"># close page</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enddoc</span><span class="p">()</span>   <span class="c1"># close document</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.dashed_line">
    <p>def <span class="ident">dashed_line</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a dashed line. Same interface as line() except:
- dash_length: Length of the dash
- space_length: Length of the space between dashes</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.dashed_line', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.dashed_line" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.ellipse">
    <p>def <span class="ident">ellipse</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a ellipse</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.ellipse', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.ellipse" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.error">
    <p>def <span class="ident">error</span>(</p><p>self, msg)</p>
    </div>
    

    
  
    <div class="desc"><p>Fatal error</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.error', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.error" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="s2">&quot;Fatal error&quot;</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;FPDF error: &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.footer">
    <p>def <span class="ident">footer</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Footer to be implemented in your own inherited class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.footer', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.footer" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">footer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Footer to be implemented in your own inherited class&quot;</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.get_string_width">
    <p>def <span class="ident">get_string_width</span>(</p><p>self, s, normalized=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Get width of a string in the current font</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.get_string_width', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.get_string_width" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_string_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">normalized</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="s2">&quot;Get width of a string in the current font&quot;</span>
    <span class="c1"># normalized is parameter for internal use</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">normalized</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">cw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;cw&#39;</span><span class="p">]</span>
    <span class="n">w</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">l</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">char</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">+=</span> <span class="n">cw</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">]):</span>
                <span class="n">w</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">][</span><span class="s1">&#39;MissingWidth&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">+=</span> <span class="mi">500</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">+=</span> <span class="n">cw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">/</span> <span class="mf">100.0</span>
    <span class="k">return</span> <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">/</span> <span class="mf">1000.0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.get_x">
    <p>def <span class="ident">get_x</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get x position</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.get_x', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.get_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Get x position&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.get_y">
    <p>def <span class="ident">get_y</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get y position</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.get_y', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.get_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Get y position&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.header">
    <p>def <span class="ident">header</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Header to be implemented in your own inherited class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.header', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.header" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Header to be implemented in your own inherited class&quot;</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.image">
    <p>def <span class="ident">image</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Put an image on the page</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.image', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.image" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.line">
    <p>def <span class="ident">line</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a line</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.line', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.line" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.link">
    <p>def <span class="ident">link</span>(</p><p>self, x, y, w, h, link)</p>
    </div>
    

    
  
    <div class="desc"><p>Put a link on the page</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.link', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.link" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
    <span class="s2">&quot;Put a link on the page&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">page_links</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[(</span>
        <span class="n">x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_pt</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
        <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">h</span>             <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">link</span>
    <span class="p">)]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.ln">
    <p>def <span class="ident">ln</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Line Feed; default value is last cell height</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.ln', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.ln" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.multi_cell">
    <p>def <span class="ident">multi_cell</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Output text with automatic or explicit line breaks, returns
boolean if page break triggered in output mode</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.multi_cell', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.multi_cell" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.normalize_text">
    <p>def <span class="ident">normalize_text</span>(</p><p>self, txt)</p>
    </div>
    

    
  
    <div class="desc"><p>Check that text input is in the correct format/encoding</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.normalize_text', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.normalize_text" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">normalize_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">):</span>
    <span class="s2">&quot;Check that text input is in the correct format/encoding&quot;</span>
    <span class="c1"># - for TTF unicode fonts: unicode object (utf8 encoding)</span>
    <span class="c1"># - for built-in fonts: string instances (encoding: latin-1, cp1252)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">txt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;latin-1&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">txt</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.open">
    <p>def <span class="ident">open</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Begin document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.open', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.open" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Begin document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.output">
    <p>def <span class="ident">output</span>(</p><p>self, name=&#39;&#39;, dest=&#39;&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Output PDF to some destination</p>
<p>By default the PDF is written to sys.stdout. If a name is given, the
PDF is written to a new file. If dest='S' is given, the PDF data is
returned as a byte string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.output', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.output" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Output PDF to some destination</span>
<span class="sd">    By default the PDF is written to sys.stdout. If a name is given, the</span>
<span class="sd">    PDF is written to a new file. If dest=&#39;S&#39; is given, the PDF data is</span>
<span class="sd">    returned as a byte string.&quot;&quot;&quot;</span>
    <span class="c1"># Finish document if necessary</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">dest</span>                      <span class="o">=</span> <span class="n">dest</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
        <span class="k">else</span><span class="p">:</span>            <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>
    <span class="k">if</span> <span class="n">PY3K</span><span class="p">:</span>
        <span class="c1"># manage binary data as latin1 until PEP461 or similar is</span>
        <span class="c1"># implemented</span>
        <span class="nb">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span>
    <span class="k">if</span> <span class="n">dest</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span>
        <span class="c1"># Python &lt; 3 writes byte data transparently without &quot;buffer&quot;</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="s1">&#39;buffer&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
        <span class="c1"># Save to local file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
    <span class="c1"># Return as a byte string</span>
    <span class="k">elif</span> <span class="n">dest</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="nb">buffer</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect output destination: &#39;</span> <span class="o">+</span> <span class="n">dest</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.page_no">
    <p>def <span class="ident">page_no</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get current page number</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.page_no', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.page_no" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">page_no</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s2">&quot;Get current page number&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.rect">
    <p>def <span class="ident">rect</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Draw a rectangle</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.rect', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.rect" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.rotate">
    <p>def <span class="ident">rotate</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.rotate', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.rotate" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_author">
    <p>def <span class="ident">set_author</span>(</p><p>self, author)</p>
    </div>
    

    
  
    <div class="desc"><p>Author of document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_author', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_author" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_author</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
    <span class="s2">&quot;Author of document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_auto_page_break">
    <p>def <span class="ident">set_auto_page_break</span>(</p><p>self, auto, margin=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Set auto page break mode and triggering margin</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_auto_page_break', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_auto_page_break" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_auto_page_break</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s2">&quot;Set auto page break mode and triggering margin&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">auto_page_break</span> <span class="o">=</span> <span class="n">auto</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b_margin</span> <span class="o">=</span> <span class="n">margin</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">page_break_trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="n">margin</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_compression">
    <p>def <span class="ident">set_compression</span>(</p><p>self, compress)</p>
    </div>
    

    
  
    <div class="desc"><p>Set page compression</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_compression', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_compression" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compress</span><span class="p">):</span>
    <span class="s2">&quot;Set page compression&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="n">compress</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_creation_date">
    <p>def <span class="ident">set_creation_date</span>(</p><p>self, date=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets Creation of Date time, or current time if None given.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_creation_date', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_creation_date" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_creation_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets Creation of Date time, or current time if None given.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">date</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_creator">
    <p>def <span class="ident">set_creator</span>(</p><p>self, creator)</p>
    </div>
    

    
  
    <div class="desc"><p>Creator of document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_creator', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_creator" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_creator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">creator</span><span class="p">):</span>
    <span class="s2">&quot;Creator of document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">creator</span> <span class="o">=</span> <span class="n">creator</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_display_mode">
    <p>def <span class="ident">set_display_mode</span>(</p><p>self, zoom, layout=&#39;continuous&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Set display mode in viewer</p>
<p>The "zoom" argument may be 'fullpage', 'fullwidth', 'real',
'default', or a number, interpreted as a percentage.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_display_mode', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_display_mode" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_display_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zoom</span><span class="p">,</span> <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;continuous&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set display mode in viewer</span>
<span class="sd">    The &quot;zoom&quot; argument may be &#39;fullpage&#39;, &#39;fullwidth&#39;, &#39;real&#39;,</span>
<span class="sd">    &#39;default&#39;, or a number, interpreted as a percentage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">zoom</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;fullpage&#39;</span><span class="p">,</span> <span class="s1">&#39;fullwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">=</span> <span class="n">zoom</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_mode</span> <span class="o">=</span> <span class="n">zoom</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect zoom display mode: &#39;</span> <span class="o">+</span> <span class="n">zoom</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">layout</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="s1">&#39;continuous&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout_mode</span> <span class="o">=</span> <span class="n">layout</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Incorrect layout display mode: &#39;</span> <span class="o">+</span> <span class="n">layout</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_doc_option">
    <p>def <span class="ident">set_doc_option</span>(</p><p>self, opt, value)</p>
    </div>
    

    
  
    <div class="desc"><p>Set document option</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_doc_option', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_doc_option" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_doc_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="s2">&quot;Set document option&quot;</span>
    <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s2">&quot;core_fonts_encoding&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts_encoding</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;Unknown document option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_draw_color">
    <p>def <span class="ident">set_draw_color</span>(</p><p>self, r, g=-1, b=-1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set color for all stroking operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_draw_color', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_draw_color" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_draw_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="s2">&quot;Set color for all stroking operations&quot;</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> G&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> RG&#39;</span><span class="p">,</span>
                                  <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_color</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_fill_color">
    <p>def <span class="ident">set_fill_color</span>(</p><p>self, r, g=-1, b=-1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set color for all filling operations</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_fill_color', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_fill_color" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_fill_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="s2">&quot;Set color for all filling operations&quot;</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> g&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> rg&#39;</span><span class="p">,</span>
                                  <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_font">
    <p>def <span class="ident">set_font</span>(</p><p>self, family, style=&#39;&#39;, size=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Select a font; size given in points</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_font', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_font" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s2">&quot;Select a font; size given in points&quot;</span>
    <span class="n">family</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">family</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;arial&#39;</span><span class="p">):</span>
        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;helvetica&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;symbol&#39;</span> <span class="ow">or</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;zapfdingbats&#39;</span><span class="p">):</span>
        <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;U&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;IB&#39;</span><span class="p">):</span>
        <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;BI&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>
    <span class="c1"># Test if font is already selected</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">family</span> <span class="ow">and</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span> <span class="o">==</span> <span class="n">style</span> <span class="ow">and</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">==</span> <span class="n">size</span><span class="p">):</span> <span class="k">return</span>
    <span class="c1"># Test if used for the first time</span>
    <span class="n">fontkey</span> <span class="o">=</span> <span class="n">family</span> <span class="o">+</span> <span class="n">style</span>
    <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">:</span>
        <span class="c1"># Check if one of standard fonts</span>
        <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fpdf_charwidths</span><span class="p">:</span>
                <span class="c1"># Load metric file</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FPDF_FONT_DIR</span><span class="p">,</span> <span class="n">family</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;times&#39;</span> <span class="ow">or</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;helvetica&#39;</span><span class="p">):</span>
                    <span class="n">name</span> <span class="o">+=</span> <span class="n">style</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.font&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
                    <span class="k">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.font&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">fontkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fpdf_charwidths</span><span class="p">:</span>
                    <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Could not include font metric file for&#39;</span> <span class="o">+</span>
                               <span class="n">fontkey</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;i&#39;</span>    <span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span> <span class="p">:</span> <span class="s1">&#39;core&#39;</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">],</span>
                <span class="s1">&#39;up&#39;</span>   <span class="p">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;ut&#39;</span>   <span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s1">&#39;cw&#39;</span>   <span class="p">:</span> <span class="n">fpdf_charwidths</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fpdf_error</span><span class="p">(</span><span class="s1">&#39;Undefined font: &#39;</span> <span class="o">+</span> <span class="n">family</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">style</span><span class="p">)</span>
    <span class="c1"># Select it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_family</span>   <span class="o">=</span> <span class="n">family</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_style</span>    <span class="o">=</span> <span class="n">style</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span>  <span class="o">=</span> <span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>     <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unifontsubset</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fonts</span><span class="p">[</span><span class="n">fontkey</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TTF&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT /F</span><span class="si">%d</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Tf ET&#39;</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_font_size">
    <p>def <span class="ident">set_font_size</span>(</p><p>self, size)</p>
    </div>
    

    
  
    <div class="desc"><p>Set font size in points</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_font_size', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_font_size" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_font_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="s2">&quot;Set font size in points&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">==</span> <span class="n">size</span><span class="p">):</span> <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span> <span class="o">=</span> <span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>    <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT /F</span><span class="si">%d</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> Tf ET&#39;</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">current_font</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">font_size_pt</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_keywords">
    <p>def <span class="ident">set_keywords</span>(</p><p>self, keywords)</p>
    </div>
    

    
  
    <div class="desc"><p>Keywords of document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_keywords', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_keywords" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="p">):</span>
    <span class="s2">&quot;Keywords of document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_left_margin">
    <p>def <span class="ident">set_left_margin</span>(</p><p>self, margin)</p>
    </div>
    

    
  
    <div class="desc"><p>Set left margin</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_left_margin', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_left_margin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_left_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
    <span class="s2">&quot;Set left margin&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span> <span class="o">=</span> <span class="n">margin</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">margin</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">margin</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_line_width">
    <p>def <span class="ident">set_line_width</span>(</p><p>self, width)</p>
    </div>
    

    
  
    <div class="desc"><p>Set line width</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_line_width', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_line_width" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_line_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
    <span class="s2">&quot;Set line width&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="n">width</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> w&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_link">
    <p>def <span class="ident">set_link</span>(</p><p>self, link, y=0, page=-1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set destination of internal link</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_link', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_link" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">page</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="s2">&quot;Set destination of internal link&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">y</span>    <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="n">y</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">link</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">page</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_margins">
    <p>def <span class="ident">set_margins</span>(</p><p>self, left, top, right=-1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set left, top and right margins</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_margins', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_margins" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="s2">&quot;Set left, top and right margins&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span> <span class="o">=</span> <span class="n">left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_margin</span> <span class="o">=</span> <span class="n">top</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">=</span> <span class="n">right</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_right_margin">
    <p>def <span class="ident">set_right_margin</span>(</p><p>self, margin)</p>
    </div>
    

    
  
    <div class="desc"><p>Set right margin</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_right_margin', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_right_margin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_right_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
    <span class="s2">&quot;Set right margin&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r_margin</span> <span class="o">=</span> <span class="n">margin</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_stretching">
    <p>def <span class="ident">set_stretching</span>(</p><p>self, factor)</p>
    </div>
    

    
  
    <div class="desc"><p>Set from stretch factor percents (default: 100.0)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_stretching', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_stretching" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_stretching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
    <span class="s2">&quot;Set from stretch factor percents (default: 100.0)&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">==</span> <span class="n">factor</span><span class="p">):</span> <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span> <span class="o">=</span> <span class="n">factor</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_out</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;BT </span><span class="si">%.2f</span><span class="s1"> Tz ET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_stretching</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_subject">
    <p>def <span class="ident">set_subject</span>(</p><p>self, subject)</p>
    </div>
    

    
  
    <div class="desc"><p>Subject of document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_subject', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_subject" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_subject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subject</span><span class="p">):</span>
    <span class="s2">&quot;Subject of document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="n">subject</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_text_color">
    <p>def <span class="ident">set_text_color</span>(</p><p>self, r, g=-1, b=-1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set color for text</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_text_color', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_text_color" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_text_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="s2">&quot;Set color for text&quot;</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> g&#39;</span><span class="p">,</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> rg&#39;</span><span class="p">,</span>
                                  <span class="n">r</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">g</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color_flag</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_color</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_color</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_title">
    <p>def <span class="ident">set_title</span>(</p><p>self, title)</p>
    </div>
    

    
  
    <div class="desc"><p>Title of document</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_title', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_title" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="s2">&quot;Title of document&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_top_margin">
    <p>def <span class="ident">set_top_margin</span>(</p><p>self, margin)</p>
    </div>
    

    
  
    <div class="desc"><p>Set top margin</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_top_margin', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_top_margin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_top_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
    <span class="s2">&quot;Set top margin&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_margin</span> <span class="o">=</span> <span class="n">margin</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_x">
    <p>def <span class="ident">set_x</span>(</p><p>self, x)</p>
    </div>
    

    
  
    <div class="desc"><p>Set x position</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_x', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="s2">&quot;Set x position&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">x</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_xy">
    <p>def <span class="ident">set_xy</span>(</p><p>self, x, y)</p>
    </div>
    

    
  
    <div class="desc"><p>Set x and y positions</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_xy', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_xy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="s2">&quot;Set x and y positions&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.set_y">
    <p>def <span class="ident">set_y</span>(</p><p>self, y)</p>
    </div>
    

    
  
    <div class="desc"><p>Set y position and reset x</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.set_y', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.set_y" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="s2">&quot;Set y position and reset x&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l_margin</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">else</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.text">
    <p>def <span class="ident">text</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Output a string</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.text', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.text" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.FPDF.write">
    <p>def <span class="ident">write</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Output text in flowing mode</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.FPDF.write', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.FPDF.write" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">page</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_only&#39;</span><span class="p">):</span>
        <span class="n">fpdf_error</span><span class="p">(</span><span class="s2">&quot;No page open, you need to call add_page() first&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="fpdf.HTMLMixin" class="name">class <span class="ident">HTMLMixin</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.HTMLMixin', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.HTMLMixin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">HTMLMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">write_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">image_map</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Parse HTML and convert it to PDF&quot;</span>
        <span class="n">h2p</span> <span class="o">=</span> <span class="n">HTML2FPDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_map</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">h2p</span><span class="o">.</span><span class="n">unescape</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1"># To deal with HTML entities</span>
        <span class="n">h2p</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#fpdf.HTMLMixin">HTMLMixin</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="fpdf.HTMLMixin.write_html">
    <p>def <span class="ident">write_html</span>(</p><p>self, text, image_map=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse HTML and convert it to PDF</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.HTMLMixin.write_html', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.HTMLMixin.write_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">write_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">image_map</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s2">&quot;Parse HTML and convert it to PDF&quot;</span>
    <span class="n">h2p</span> <span class="o">=</span> <span class="n">HTML2FPDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_map</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">h2p</span><span class="o">.</span><span class="n">unescape</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1"># To deal with HTML entities</span>
    <span class="n">h2p</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="fpdf.Template" class="name">class <span class="ident">Template</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Template</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">creator</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">elements</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> 
                         <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">barcode</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">FPDF</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="n">format</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_author</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_creator</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_subject</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_keywords</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="s2">&quot;Initialize the internal element structures&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">parse_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">decimal_sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="s2">&quot;Parse template format csv file and create elements dict&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="s1">&#39;underline&#39;</span><span class="p">,</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span><span class="s1">&#39;background&#39;</span><span class="p">,</span>
            <span class="s1">&#39;align&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="s1">&#39;multiline&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">):</span>
                <span class="n">kargs</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decimal_sep</span><span class="o">!=</span><span class="s2">&quot;.&quot;</span><span class="p">:</span> 
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">decimal_sep</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="k">if</span> <span class="n">v</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">kargs</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="p">][</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># setitem shortcut (may be further extended)</span>
    <span class="nb">set</span> <span class="o">=</span> <span class="fm">__setitem__</span>

    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span>
        
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">:</span>
                <span class="c1"># text for this page:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># find first element for default text:</span>
                <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
                    <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">elements</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">split_multicell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">element_name</span><span class="p">):</span>
        <span class="s2">&quot;Divide (</span><span class="se">\n</span><span class="s2">) a string using a given element width&quot;</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span>
        <span class="n">element</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
            <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">element_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
        <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;italic&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
        <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;underline&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;font&#39;</span><span class="p">],</span><span class="n">style</span><span class="p">,</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>
        <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">])</span> <span class="c1"># D/I in spanish</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">],</span>
                             <span class="n">h</span><span class="o">=</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;y2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">],</span>
                             <span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span><span class="n">split_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">):</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span>
        <span class="k">for</span> <span class="n">pg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]):</span>
                <span class="c1">#print &quot;dib&quot;,element[&#39;type&#39;], element[&#39;name&#39;], element[&#39;x1&#39;], element[&#39;y1&#39;], element[&#39;x2&#39;], element[&#39;y2&#39;]</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">element</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="n">pg</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;rotate&#39;</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                    <span class="n">pdf</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;rotate&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()](</span><span class="n">pdf</span><span class="p">,</span> <span class="o">**</span><span class="n">element</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;rotate&#39;</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                    <span class="n">pdf</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">dest</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
             <span class="n">bold</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> 
             <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">backgroud</span><span class="o">=</span><span class="mi">65535</span><span class="p">,</span> <span class="n">multiline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">text_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">set_text_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">fill_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">):</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">set_fill_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">))</span>

            <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;arial black&#39;</span><span class="p">:</span>
                <span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
            <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&lt;/</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span><span class="n">tag</span><span class="p">)):</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                    <span class="n">style</span> <span class="o">+=</span> <span class="n">tag</span>
            <span class="k">if</span> <span class="n">bold</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
            <span class="k">if</span> <span class="n">italic</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
            <span class="k">if</span> <span class="n">underline</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
            <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">align</span><span class="p">)</span> <span class="c1"># D/I in spanish</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">font</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
            <span class="c1">##m_k = 72 / 2.54</span>
            <span class="c1">##h = (size/m_k)</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">multiline</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># multiline==None: write without wrapping/trimming (default)</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ln</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">multiline</span><span class="p">:</span>
                <span class="c1"># multiline==True: automatic word - warp</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># multiline==False: trim to fit exactly the space defined</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span>
                             <span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">split_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;trimming: *</span><span class="si">%s</span><span class="s2">*&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ln</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>

            <span class="c1">#pdf.Text(x=x1,y=y1,txt=text)</span>

    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
            <span class="c1">#print &quot;SetDrawColor&quot;, hex(foreground)</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
        <span class="c1">#print &quot;SetLineWidth&quot;, size</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_line_width</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">backgroud</span><span class="o">=</span><span class="mi">65535</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">fill_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_fill_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">))</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_line_width</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">link</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">barcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;interleaved 2of5 nt&#39;</span><span class="p">:</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">interleaved2of5</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>

    <span class="c1"># Added by Derek Schwalenberg Schwalenberg1013@gmail.com to allow (url) links in templates (using write method) 2014-02-22</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">bold</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://example.com&#39;</span><span class="p">,</span>
             <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">text_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_text_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;arial black&#39;</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&lt;/</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span><span class="n">tag</span><span class="p">)):</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">style</span> <span class="o">+=</span> <span class="n">tag</span>
        <span class="k">if</span> <span class="n">bold</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
        <span class="k">if</span> <span class="n">italic</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
        <span class="k">if</span> <span class="n">underline</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
        <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">align</span><span class="p">)</span> <span class="c1"># D/I in spanish</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">font</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
        <span class="c1">##m_k = 72 / 2.54</span>
        <span class="c1">##h = (size/m_k)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#fpdf.Template">Template</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="fpdf.Template.handlers" class="name">var <span class="ident">handlers</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="fpdf.Template.texts" class="name">var <span class="ident">texts</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="fpdf.Template.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, infile=None, elements=None, format=&#39;A4&#39;, orientation=&#39;portrait&#39;, title=&#39;&#39;, author=&#39;&#39;, subject=&#39;&#39;, creator=&#39;&#39;, keywords=&#39;&#39;)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.__init__', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">creator</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">elements</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> 
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">barcode</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">FPDF</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="n">format</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_author</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_creator</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_subject</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_keywords</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.add_page">
    <p>def <span class="ident">add_page</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.add_page', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.add_page" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.barcode">
    <p>def <span class="ident">barcode</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, text=&#39;&#39;, font=&#39;arial&#39;, size=1, foreground=0, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.barcode', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.barcode" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">barcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;interleaved 2of5 nt&#39;</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">interleaved2of5</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.has_key">
    <p>def <span class="ident">has_key</span>(</p><p>self, name)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.has_key', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.has_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.image">
    <p>def <span class="ident">image</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, text=&#39;&#39;, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.image', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.image" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">link</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.line">
    <p>def <span class="ident">line</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, size=0, foreground=0, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.line', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.line" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
        <span class="c1">#print &quot;SetDrawColor&quot;, hex(foreground)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
    <span class="c1">#print &quot;SetLineWidth&quot;, size</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_line_width</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.load_elements">
    <p>def <span class="ident">load_elements</span>(</p><p>self, elements)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize the internal element structures</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.load_elements', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.load_elements" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">load_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
    <span class="s2">&quot;Initialize the internal element structures&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.parse_csv">
    <p>def <span class="ident">parse_csv</span>(</p><p>self, infile, delimiter=&#39;,&#39;, decimal_sep=&#39;.&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Parse template format csv file and create elements dict</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.parse_csv', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.parse_csv" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">decimal_sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
    <span class="s2">&quot;Parse template format csv file and create elements dict&quot;</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="s1">&#39;underline&#39;</span><span class="p">,</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span><span class="s1">&#39;background&#39;</span><span class="p">,</span>
        <span class="s1">&#39;align&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="s1">&#39;multiline&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">):</span>
            <span class="n">kargs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">decimal_sep</span><span class="o">!=</span><span class="s2">&quot;.&quot;</span><span class="p">:</span> 
                    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">decimal_sep</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="n">kargs</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.rect">
    <p>def <span class="ident">rect</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, size=0, foreground=0, backgroud=65535, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.rect', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.rect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">backgroud</span><span class="o">=</span><span class="mi">65535</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">draw_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_draw_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">fill_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">):</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_fill_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">))</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_line_width</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.render">
    <p>def <span class="ident">render</span>(</p><p>self, outfile, dest=&#39;F&#39;)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.render', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.render" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">):</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span>
    <span class="k">for</span> <span class="n">pg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">add_page</span><span class="p">()</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_auto_page_break</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]):</span>
            <span class="c1">#print &quot;dib&quot;,element[&#39;type&#39;], element[&#39;name&#39;], element[&#39;x1&#39;], element[&#39;y1&#39;], element[&#39;x2&#39;], element[&#39;y2&#39;]</span>
            <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">element</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="n">pg</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;rotate&#39;</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;rotate&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">],</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()](</span><span class="n">pdf</span><span class="p">,</span> <span class="o">**</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;rotate&#39;</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                <span class="n">pdf</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">dest</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.set">
    <p>def <span class="ident">set</span>(</p><p>self, name, value)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.set', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.set" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PY3K</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pg_no</span><span class="p">][</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.split_multicell">
    <p>def <span class="ident">split_multicell</span>(</p><p>self, text, element_name)</p>
    </div>
    

    
  
    <div class="desc"><p>Divide (
) a string using a given element width</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.split_multicell', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.split_multicell" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">split_multicell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">element_name</span><span class="p">):</span>
    <span class="s2">&quot;Divide (</span><span class="se">\n</span><span class="s2">) a string using a given element width&quot;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span>
    <span class="n">element</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
        <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">element_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
    <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;italic&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
    <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;underline&#39;</span><span class="p">]:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;font&#39;</span><span class="p">],</span><span class="n">style</span><span class="p">,</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>
    <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;align&#39;</span><span class="p">])</span> <span class="c1"># D/I in spanish</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">PY3K</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;latin1&quot;</span><span class="p">,</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">],</span>
                         <span class="n">h</span><span class="o">=</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;y2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">element</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">],</span>
                         <span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span><span class="n">split_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.text">
    <p>def <span class="ident">text</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, text=&#39;&#39;, font=&#39;arial&#39;, size=10, bold=False, italic=False, underline=False, align=&#39;&#39;, foreground=0, backgroud=65535, multiline=None, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.text', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.text" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
         <span class="n">bold</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> 
         <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">backgroud</span><span class="o">=</span><span class="mi">65535</span><span class="p">,</span> <span class="n">multiline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
         <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">text_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_text_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">fill_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">):</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">set_fill_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">backgroud</span><span class="p">))</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;arial black&#39;</span><span class="p">:</span>
            <span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
        <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&lt;/</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span><span class="n">tag</span><span class="p">)):</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">style</span> <span class="o">+=</span> <span class="n">tag</span>
        <span class="k">if</span> <span class="n">bold</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
        <span class="k">if</span> <span class="n">italic</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
        <span class="k">if</span> <span class="n">underline</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
        <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">align</span><span class="p">)</span> <span class="c1"># D/I in spanish</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">font</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
        <span class="c1">##m_k = 72 / 2.54</span>
        <span class="c1">##h = (size/m_k)</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">multiline</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># multiline==None: write without wrapping/trimming (default)</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ln</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">multiline</span><span class="p">:</span>
            <span class="c1"># multiline==True: automatic word - warp</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># multiline==False: trim to fit exactly the space defined</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">multi_cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span>
                         <span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">split_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;trimming: *</span><span class="si">%s</span><span class="s2">*&quot;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">txt</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ln</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="fpdf.Template.write">
    <p>def <span class="ident">write</span>(</p><p>self, pdf, x1=0, y1=0, x2=0, y2=0, text=&#39;&#39;, font=&#39;arial&#39;, size=1, bold=False, italic=False, underline=False, align=&#39;&#39;, link=&#39;http://example.com&#39;, foreground=0, *args, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-fpdf.Template.write', this);">Show source &equiv;</a></p>
  <div id="source-fpdf.Template.write" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s2">&quot;arial&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">bold</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://example.com&#39;</span><span class="p">,</span>
         <span class="n">foreground</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pdf</span><span class="o">.</span><span class="n">text_color</span><span class="o">!=</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">):</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">set_text_color</span><span class="p">(</span><span class="o">*</span><span class="n">rgb</span><span class="p">(</span><span class="n">foreground</span><span class="p">))</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">font</span> <span class="o">==</span> <span class="s1">&#39;arial black&#39;</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
    <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">and</span> <span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&lt;/</span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span><span class="n">tag</span><span class="p">)):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">style</span> <span class="o">+=</span> <span class="n">tag</span>
    <span class="k">if</span> <span class="n">bold</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;B&quot;</span>
    <span class="k">if</span> <span class="n">italic</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;I&quot;</span>
    <span class="k">if</span> <span class="n">underline</span><span class="p">:</span> <span class="n">style</span> <span class="o">+=</span> <span class="s2">&quot;U&quot;</span>
    <span class="n">align</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">align</span><span class="p">)</span> <span class="c1"># D/I in spanish</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">font</span><span class="p">,</span><span class="n">style</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
    <span class="c1">##m_k = 72 / 2.54</span>
    <span class="c1">##h = (size/m_k)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">link</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

    <h2 class="section-title" id="header-submodules">Sub-modules</h2>
      <div class="item">
      <p class="name"><a href="errors.m.html">fpdf.errors</a></p>
      
  
    <div class="desc"><p>FPDF Error classes</p></div>

      </div>
      <div class="item">
      <p class="name"><a href="fonts.m.html">fpdf.fonts</a></p>
      
  

      </div>
      <div class="item">
      <p class="name"><a href="fpdf.m.html">fpdf.fpdf</a></p>
      
  
    <div class="desc"><p>fpdf module (in fpdf package housing FPDF class)</p>
<p>This module contains FPDF class inspiring this library. The version number is
updated here (above and below in variable).</p></div>

      </div>
      <div class="item">
      <p class="name"><a href="html.m.html">fpdf.html</a></p>
      
  
    <div class="desc"><p>HTML Renderer for FPDF.py</p></div>

      </div>
      <div class="item">
      <p class="name"><a href="image_parsing.m.html">fpdf.image_parsing</a></p>
      
  

      </div>
      <div class="item">
      <p class="name"><a href="php.m.html">fpdf.php</a></p>
      
  

      </div>
      <div class="item">
      <p class="name"><a href="py3k.m.html">fpdf.py3k</a></p>
      
  
    <div class="desc"><p>Special module to handle differences between Python 2 and 3 versions</p></div>

      </div>
      <div class="item">
      <p class="name"><a href="template.m.html">fpdf.template</a></p>
      
  
    <div class="desc"><p>PDF Template Helper for FPDF.py</p></div>

      </div>
      <div class="item">
      <p class="name"><a href="ttfonts.m.html">fpdf.ttfonts</a></p>
      
  

      </div>
      <div class="item">
      <p class="name"><a href="util.m.html">fpdf.util</a></p>
      
  
    <div class="desc"><p>Utility Functions (previously FPDF#methods)</p></div>

      </div>
  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
